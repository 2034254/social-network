"use strict";(self.webpackChunksocial_network_client=self.webpackChunksocial_network_client||[]).push([[992],{3448:(e,s,t)=>{t.r(s),t.d(s,{default:()=>$});var i=t(72791),a=t(66826),n=t(47823),l=t(62836),r=t(61487),o=t(22417),d=t(40834),c=t(93825),h=t(91460),p=t(62966),m=t(78417),u=t(14541),g=t.n(u),x=t(76915),j=t(72447),f=t(94018),v=t.n(f),Z=(t(89390),t(29679)),N=t(82288),b=t(44102),C=t(72898);const w="image/x-png, image/png, image/jpg, image/jpeg, image/gif",y=w.split(",").map((e=>e.trim())),S={description:"",imgSrc:null,imgSrcExt:null,imageUploadEndpoint:"",crop:{aspect:1}};class F extends i.PureComponent{constructor(){super(...arguments),this.imagePreviewCanvasRef=i.createRef(),this.fileInputRef=i.createRef(),this.state=S,this.handleChange=e=>{this.setState({description:e.target.value})},this.handleOnCropChange=e=>{this.setState({crop:e})},this.handleOnCropComplete=(e,s)=>{const t=this.imagePreviewCanvasRef.current,{imgSrc:i}=this.state;(0,Z.tI)(t,i,s),this.setState({cropped:!0})},this.handleUpload=e=>{e.preventDefault();const{imgSrc:s}=this.state;if(s){const e=this.imagePreviewCanvasRef.current,{imgSrcExt:s}=this.state,t=e.toDataURL("image/"+s),i="previewFile."+s,a=(0,Z.TP)(t,i),n=new FormData;n.append("photo",a,a.name),n.append("description",this.state.description);const{dispatch:l}=this.props;l(N.r.addProfiePicture(n)),this.setState(S)}},this.verifyFile=e=>{if(e&&e.length>0){const s=e[0],t=s.type,i=s.size,{dispatch:a}=this.props;return y.includes(t)?!(i>1e7)||(a(b.I.error("This file is not allowed. "+i+" bytes is too large")),!1):(a(b.I.error("This file is not allowed. Only images are allowed.")),!1)}},this.handleFileSelect=e=>{const s=e.target.files;if(s&&s.length>0){if(this.verifyFile(s)){const e=s[0],t=new FileReader;t.addEventListener("load",(()=>{const e=t.result;this.setState({imgSrc:e,imgSrcExt:(0,Z.FN)(e)})}),!1),t.readAsDataURL(e)}}}}render(){const{imgSrc:e,cropped:s}=this.state;return(0,C.jsx)("div",{children:null!==e?(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{style:{marginBottom:"1%"},children:(0,C.jsxs)("label",{className:"ui icon button fluid",children:[(0,C.jsx)("i",{className:"file icon "}),"Change Image",(0,C.jsx)("input",{style:{display:"none"},ref:this.fileInputRef,type:"file",accept:w,multiple:!1,onChange:this.handleFileSelect})]})}),(0,C.jsx)(v(),{src:e,crop:this.state.crop,onComplete:this.handleOnCropComplete,onChange:this.handleOnCropChange}),s?(0,C.jsx)(d.Z,{primary:!0,fluid:!0,onClick:this.handleUpload,children:"Upload"}):null,(0,C.jsx)("canvas",{style:{display:"none"},ref:this.imagePreviewCanvasRef})]}):(0,C.jsx)("div",{children:(0,C.jsxs)("label",{className:"ui icon button fluid",children:[(0,C.jsx)("i",{className:"file icon"}),"Select Image",(0,C.jsx)("input",{style:{display:"none"},ref:this.fileInputRef,type:"file",accept:w,multiple:!1,onChange:this.handleFileSelect})]})})})}}const U=(0,a.$j)()(F);class P extends i.Component{constructor(){super(...arguments),this.state={open:!1},this.open=()=>this.setState({open:!0}),this.close=()=>this.setState({open:!1})}render(){const{open:e}=this.state;return(0,C.jsxs)(n.Z,{open:e,onOpen:this.open,onClose:this.close,size:"small",trigger:(0,C.jsx)(d.Z,{size:"big",content:"Update profile picture",primary:!0,fluid:!0}),children:[(0,C.jsx)(n.Z.Header,{children:"Select profile picture"}),(0,C.jsx)(n.Z.Content,{children:(0,C.jsx)(U,{})})]})}}class D extends i.Component{constructor(){super(...arguments),this.state={firstName:"",lastName:"",username:"",email:"",bio:"",isDisabled:!0},this.componentDidMount=()=>{const{firstName:e,lastName:s,username:t,email:i,bio:a}=this.props;this.setState({firstName:e,lastName:s,username:t,email:i,bio:a,isDisabled:!0})},this.handleChange=(e,s)=>{let{name:t,value:i}=s;this.setState({isDisabled:!1,[t]:i})},this.handleSubmit=()=>{const{dispatch:e}=this.props;e(x.h.updateUserData(this.state)),this.setState({isDisabled:!0})}}render(){const{firstName:e,lastName:s,username:t,email:i,bio:a}=this.state,{updaingUser:l,hasError:r}=this.props;return(0,C.jsxs)(n.Z,{trigger:this.props.children,style:{color:"reda"},children:[(0,C.jsx)(n.Z.Header,{children:"Edit profile"}),(0,C.jsx)(n.Z.Content,{children:(0,C.jsxs)(n.Z.Description,{children:[r?(0,C.jsx)(h.Z,{negative:!0,children:(0,C.jsx)("p",{children:r})}):null,(0,C.jsxs)(j.Z,{size:"huge",name:"form",onSubmit:this.handleSubmit,loading:!!l,children:[(0,C.jsxs)(j.Z.Group,{widths:"equal",children:[(0,C.jsx)(j.Z.Input,{fluid:!0,label:"First Name",placeholder:"First Name",type:"text",name:"firstName",onChange:this.handleChange,value:e}),(0,C.jsx)(j.Z.Input,{fluid:!0,label:"Last Name",placeholder:"Last Name",type:"text",name:"lastName",onChange:this.handleChange,value:s})]}),(0,C.jsxs)(j.Z.Group,{widths:"equal",children:[(0,C.jsx)(j.Z.Input,{fluid:!0,label:"Username",placeholder:"Username",type:"text",name:"username",onChange:this.handleChange,value:t}),(0,C.jsx)(j.Z.Input,{fluid:!0,label:"Email",placeholder:"Email",type:"text",name:"email",onChange:this.handleChange,value:i})]}),(0,C.jsx)(j.Z.TextArea,{style:{minHeight:100,maxHeight:100},label:"About",placeholder:"Tell us more about you...",type:"text",name:"bio",onChange:this.handleChange,value:a}),(0,C.jsx)(d.Z,{style:{marginBottom:"1%"},size:"big",content:"Update information",disabled:this.state.isDisabled,primary:!0,fluid:!0}),(0,C.jsx)(P,{})]})]})})]})}}const I=(0,a.$j)((function(e){const{updaingUser:s,hasError:t}=e.user,{firstName:i,lastName:a,username:n,email:l,bio:r}=e.user.data;return{updaingUser:s,hasError:t,firstName:i,lastName:a,username:n,email:l,bio:r}}))(D);var k=t(85168),z=t(11589),_=t.n(z),E=t(58612),R=t(97202),A=t.n(R),L=t(47749),G=t.n(L),H=t(59129),O=t(52970);A()(E),G()(E);const T={formatHref:function(e,s){return"hashtag"===s&&(e="/hashtags/"+e.substring(1)),"mention"===s&&(e="/"+e.substring(1)),e},attributes:{target:{url:"_blank"}}};class M extends i.Component{constructor(){super(...arguments),this.componentDidMount=()=>{document.title="Profile | social-network"},this.fetchData=()=>{const{dispatch:e,user:s}=this.props,t=s.data.posts[s.data.posts.length-1]._id;e(x.h.getPosts({userId:s.data._id,lastId:t}))},this.getFollowings=()=>{const{dispatch:e,user:s}=this.props;e(x.h.getFollowings(s.data._id))},this.getFollowers=()=>{const{dispatch:e,user:s}=this.props;e(x.h.getFollowers(s.data._id))}}render(){const{user:e,alert:s}=this.props,t=e.data.postsCount!==e.data.posts.length,a=e.data.posts.map((s=>(0,C.jsx)(n.Z,{size:"small",trigger:(0,C.jsxs)("div",{className:"gallery-item",children:[(0,C.jsx)("img",{src:"/images/post-images/thumbnail/".concat(s.photo),className:"gallery-image",alt:""}),(0,C.jsx)("div",{className:"gallery-item-info",children:(0,C.jsxs)("ul",{children:[(0,C.jsxs)("li",{className:"gallery-item-likes",children:[(0,C.jsx)("span",{className:"visually-hidden",children:"Likes:"}),(0,C.jsx)(l.Z,{name:"heart"})," ",s.likes]}),(0,C.jsxs)("li",{className:"gallery-item-comments",children:[(0,C.jsx)("span",{className:"visually-hidden",children:"Comments:"}),(0,C.jsx)(l.Z,{name:"comment"})," ",s.comments]})]})})]}),children:(0,C.jsx)(O.Z,{post:{...s,author:[{profilePicture:e.data.profilePicture,username:e.data.username,_id:e.data._id}]}})},s._id))),u=e.data.follwingUsers.length?e.data.follwingUsers.map((e=>{let{user:s}=e;return(0,C.jsx)(H.Z,{user:s},s._id)})):"No followings",x=e.data.followerUsers.length?e.data.followerUsers.map((e=>{let{user:s}=e;return(0,C.jsx)(H.Z,{user:s},s._id)})):"No followers";return(0,C.jsx)("div",{className:"main",children:e.loadingUser?(0,C.jsx)(r.Z,{active:!0,children:(0,C.jsx)(o.Z,{})}):(0,C.jsxs)(i.Fragment,{children:[e.deleting?(0,C.jsx)(r.Z,{active:!0,children:(0,C.jsx)(o.Z,{})}):null,(0,C.jsx)("header",{children:(0,C.jsxs)("div",{className:"container",children:[s.type?(0,C.jsx)(k.Z,{alert:s}):null,(0,C.jsxs)("div",{className:"profile",children:[(0,C.jsx)("div",{className:"profile-image",children:(0,C.jsx)("img",{src:"/images/profile-picture/100x100/".concat(e.data.profilePicture),alt:""})}),(0,C.jsxs)("div",{className:"profile-user-settings",children:[(0,C.jsx)("h1",{className:"profile-user-name",children:e.data.username}),(0,C.jsxs)(d.Z,{as:m.Z,to:"/posts/upload",className:"profile-edit-btn",size:"large",icon:!0,labelPosition:"right",children:["Add post",(0,C.jsx)(l.Z,{name:"upload"})]}),(0,C.jsx)(I,{children:(0,C.jsxs)(d.Z,{className:"profile-edit-btn",size:"large",icon:!0,labelPosition:"right",children:["Profile settings",(0,C.jsx)(l.Z,{name:"setting"})]})})]}),(0,C.jsx)("div",{className:"profile-stats",children:(0,C.jsxs)("ul",{children:[(0,C.jsxs)("li",{children:[(0,C.jsx)("span",{className:"profile-stat-count",children:e.data.postsCount})," ","posts"]}),(0,C.jsxs)(n.Z,{trigger:(0,C.jsxs)("li",{onClick:this.getFollowers,children:[(0,C.jsx)("span",{className:"profile-stat-count",children:e.data.followers})," ","followers"]}),children:[(0,C.jsx)(n.Z.Header,{children:"Followers"}),(0,C.jsx)(n.Z.Content,{scrolling:!0,children:(0,C.jsx)(n.Z.Description,{children:(0,C.jsx)(c.Z,{verticalAlign:"middle",size:"huge",children:x})})})]}),(0,C.jsxs)(n.Z,{trigger:(0,C.jsxs)("li",{onClick:this.getFollowings,children:[(0,C.jsx)("span",{className:"profile-stat-count",children:e.data.followings})," ","following"]}),children:[(0,C.jsx)(n.Z.Header,{children:"Following"}),(0,C.jsx)(n.Z.Content,{scrolling:!0,children:(0,C.jsx)(n.Z.Description,{children:(0,C.jsx)(c.Z,{verticalAlign:"middle",size:"huge",children:u})})})]})]})}),(0,C.jsxs)("div",{className:"profile-bio",children:[(0,C.jsx)("div",{className:"profile-real-name",children:e.data.firstName+" "+e.data.lastName}),(0,C.jsx)("div",{className:"profile-bio-description",children:(0,C.jsx)(_(),{options:T,children:e.data.bio})})]})]})]})}),(0,C.jsx)("main",{children:(0,C.jsx)("div",{className:"container",children:0===e.data.postsCount?(0,C.jsxs)(h.Z,{info:!0,size:"large",children:["You have no posts. Share your first picture:"," ",(0,C.jsxs)(d.Z,{as:m.Z,to:"/posts/upload",className:"profile-edit-btn",size:"large",icon:!0,labelPosition:"right",children:["Add post",(0,C.jsx)(l.Z,{name:"upload"})]})]}):(0,C.jsx)(g(),{className:"gallery",dataLength:e.data.posts.length,next:this.fetchData,hasMore:t,loader:(0,C.jsx)("h4",{children:"Loading..."}),children:a})})}),(0,C.jsx)(p.Z,{hidden:!0})]})})}}const $=(0,a.$j)((e=>({user:e.user,alert:e.alert})))(M)},85168:(e,s,t)=>{t.d(s,{Z:()=>n});t(72791);var i=t(91460),a=t(72898);function n(e){let{alert:{type:s,message:t}}=e;return"success"===s?(0,a.jsx)(i.Z,{success:!0,header:"Success",content:t}):"error"===s?(0,a.jsx)(i.Z,{error:!0,header:"Error",content:t}):null}},29679:(e,s,t)=>{function i(e,s){for(var t=e.split(","),i=t[0].match(/:(.*?);/)[1],a=atob(t[1]),n=a.length,l=new Uint8Array(n);n--;)l[n]=a.charCodeAt(n);return new File([l],s,{type:i})}function a(e){return e.substring(11,e.indexOf(";base64"))}function n(e,s,t){const i=e;i.width=t.width,i.height=t.height;const a=i.getContext("2d"),n=new Image;n.src=s,n.onload=function(){a.drawImage(n,t.x,t.y,t.width,t.height,0,0,t.width,t.height)}}t.d(s,{FN:()=>a,TP:()=>i,tI:()=>n})},22417:(e,s,t)=>{t.d(s,{Z:()=>p});var i=t(87462),a=t(81694),n=t.n(a),l=t(72791),r=t(47826),o=t(76755),d=t(86246),c=t(65831);function h(e){var s=e.active,t=e.children,a=e.className,p=e.content,m=e.disabled,u=e.indeterminate,g=e.inline,x=e.inverted,j=e.size,f=n()("ui",j,(0,r.lG)(s,"active"),(0,r.lG)(m,"disabled"),(0,r.lG)(u,"indeterminate"),(0,r.lG)(x,"inverted"),(0,r.lG)(t||p,"text"),(0,r.sU)(g,"inline"),"loader",a),v=(0,o.Z)(h,e),Z=(0,d.Z)(h,e);return l.createElement(Z,(0,i.Z)({},v,{className:f}),c.kK(t)?p:t)}h.handledProps=["active","as","children","className","content","disabled","indeterminate","inline","inverted","size"],h.propTypes={};const p=h}}]);
//# sourceMappingURL=992.c2a29e3b.chunk.js.map