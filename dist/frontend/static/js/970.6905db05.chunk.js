"use strict";(self.webpackChunksocial_network_client=self.webpackChunksocial_network_client||[]).push([[970],{82288:(e,t,o)=>{o.d(t,{r:()=>l});var s=o(73685),n=o(51935);const r={fetchPosts:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({...e})};return fetch("/api/post/getPosts/",t).then(a).then((e=>e.data))},getPostsByHashtag:function(e,t){const o={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({hashtag:e,...t})};return fetch("/api/post/getPostsByHashtag/",o).then(a).then((e=>e.data))},getPostsByLocation:function(e,t){const o={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({coordinates:e,...t})};return fetch("/api/post/getPostsByLocation/",o).then(a).then((e=>e.data))},addPost:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token},body:e};return fetch("/api/post/addPost/",t).then(a).then((e=>e.post))},addProfiePicture:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token},body:e};return fetch("/api/user/addProfiePicture/",t).then(a).then((e=>e))},deletePost:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({postId:e})};return fetch("/api/post/delete/",t).then(a).then((e=>e))},likePost:function(e,t){const o={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({postId:e,authorId:t})};return fetch("/api/post/likePost/",o).then(a).then((e=>e))},getPostLikes:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({postId:e})};return fetch("/api/post/getPostLikes/",t).then(a).then((e=>e))},getPost:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({postId:e})};return fetch("/api/post/getPost/",t).then(a).then((e=>e))},logout:i};function i(){localStorage.removeItem("user")}function a(e){return e.text().then((t=>{const o=t&&JSON.parse(t);if(!e.ok){401===e.status&&(console.log(e),i(),window.location.reload(!0));const t=o&&o.message||e.statusText;return Promise.reject(t)}return o}))}var c=o(44102);const l={mapLoactionSelect:function(e){return t=>{t({type:s.q.MAP_LOCATION_SELECT,location:e})}},changeTextareaValue:function(e){return t=>{t({type:s.q.TEXTAREA_VALUE_CAHNGE,value:e})}},canvasHasValue:function(e){return t=>{t({type:s.q.CANVAS_HAS_VALUE,hasValue:e})}},getCroppedSrc:function(e){return t=>{t({type:s.q.IMAGE_CROP_SELECT,imgSrc:e})}},selectImage:function(e,t){return o=>{o({type:s.q.IMAGE_SELECT,imgSrc:e,imgSrcExt:t})}},fetchPosts:function(e){return o=>{r.fetchPosts(e).then((n=>{if(e.initialFetch){const{posts:r,total:i}=n[0];r.forEach((e=>o({type:s.q.INIT_COMMENT,postId:e._id}))),o(t(r,i[0],e.initialFetch))}else o(t(n)),n.forEach((e=>o({type:s.q.INIT_COMMENT,postId:e._id})))}),(e=>{o(c.I.error(e))}))};function t(e,t,o){return{type:s.q.POSTS_SUCCESS,posts:e,total:t,initialFetch:o}}},getPostsByHashtag:function(e,t){return n=>{var i;n((i=t.initialFetch,{type:s.q.HASHTAG_POSTS_REQUEST,initialFetch:i})),r.getPostsByHashtag(e,t).then((s=>{if(t.initialFetch){const{posts:r,total:i}=s[0];n(o(r,i[0],t.initialFetch,e))}else n(o(s))}),(e=>{n(c.I.error(e))}))};function o(e,t,o,n){return{type:s.q.HASHTAG_POSTS_SUCCESS,posts:e,total:t,initialFetch:o,hashtag:n}}},getPostsByLocation:function(e,t){return n=>{var i;n((i=t.initialFetch,{type:s.q.LOCATION_POSTS_REQUEST,initialFetch:i})),r.getPostsByLocation(e,t).then((s=>{if(t.initialFetch){const{posts:r,total:i}=s[0];n(o(r,i[0],t.initialFetch,e))}else n(o(s))}),(e=>{n(c.I.error(e))}))};function o(e,t,o,n){return{type:s.q.LOCATION_POSTS_SUCCESS,posts:e,total:t,initialFetch:o,coordinates:n}}},deletePost:function(e){return t=>{t({type:s.q.POST_DELETE_REQUEST}),r.deletePost(e).then((e=>{var o;t((o=e,{type:s.q.POST_DELETE_SUCCESS,result:o})),t(c.I.success(e.message))}),(e=>{console.log(e)}))}},addPost:function(e){return t=>{t({type:s.q.ADD_POST_REQUEST}),r.addPost(e).then((e=>{t(function(e){return{type:s.q.ADD_POST_SUCCESS,post:e}}(e)),t(c.I.success("Post uploaded")),t({type:s.q.INIT_COMMENT,postId:e._id})}),(e=>{t(c.I.error(e))}))}},addProfiePicture:function(e){return t=>{t({type:n.A.GETUSER_REQUEST}),r.addProfiePicture(e).then((e=>{var o;t((o=e.user,{type:n.A.USER_UPDATE_PROFILEPICTURE_SUCCESS,user:o}))}),(e=>{console.log(e)}))}},likePost:function(e,t,o){return i=>{o.some((t=>t===e))?i(n(s.q.DISLIKE_POST,{postId:e})):i(n(s.q.LIKE_POST,{postId:e})),r.likePost(e,t).then((()=>{}),(e=>{console.log(e)}))};function n(e,t){return{type:e,post:t}}},getPostLikes:function(e){return t=>{r.getPostLikes(e).then((e=>{var o;t((o=e.users[0].users_likes,{type:s.q.GET_POST_LIKES,postLikes:o}))}),(e=>{console.log(e)}))}},getPost:function(e){return t=>{r.getPost(e).then((e=>{var o,n;document.title=e.post[0].author[0].username+"'s post | social-network",t((o=s.q.GET_POST,n=e.post,{type:o,post:n})),t({type:s.q.INIT_COMMENT,postId:e.post[0]._id})}),(e=>{t(c.I.error(e)),console.log(e)}))}}}},76915:(e,t,o)=>{o.d(t,{h:()=>p});var s=o(51935),n=o(73685);const r={login:function(e,t){const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})};return fetch("/api/user/login",o).then(a).then((e=>(localStorage.setItem("user",JSON.stringify({token:e.user.token})),e.user)))},logout:i,sendVerificationEmail:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})};return fetch("/api/user/sendVerificationEmail/",t).then(a)},sendforgotPasswordEmail:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})};return fetch("/api/user/sendforgotPasswordEmail/",t).then(a)},register:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("/api/user/signup/",t).then(a)},getUserData:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/getUserData",t).then(a).then((e=>e))},resetPassword:function(e){const t={method:"POST",headers:{Authorization:"Bearer "+e.jwt,"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/passwordreset",t).then(c).then((e=>e))},updateUser:function(e){delete e.isDisabled;const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("/api/user/updateUser",t).then(a).then((e=>(localStorage.setItem("user",JSON.stringify({token:e.token})),e)))},followUser:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({userId:e})};return fetch("/api/user/followUser",t).then(a).then((e=>e))},getUserProfileData:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({username:e.trim(),profilePage:!0})};return fetch("/api/user/getProfilePageData",t).then(a).then((e=>e))},getPosts:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/getPosts",t).then(a).then((e=>e))},getUserProfileFollowers:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({userId:e})};return fetch("/api/user/getUserProfileFollowers",t).then(a).then((e=>e))},getUserProfileFollowings:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({userId:e})};return fetch("/api/user/getUserProfileFollowings",t).then(a).then((e=>e))},getNewUsers:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/getNewUsers",t).then(a).then((e=>e))}};function i(){localStorage.removeItem("user")}function a(e){return e.text().then((t=>{const o=t&&JSON.parse(t);if(!e.ok){401===e.status&&(i(),window.location.reload(!0));const t=o&&o.message||e.statusText;return Promise.reject(t)}return o}))}function c(e){return e.text().then((t=>{const o=t&&JSON.parse(t);if(!e.ok){e.status;const t=o&&o.message||e.statusText;return Promise.reject(t)}return o}))}var l=o(44102),h=o(74325);const p={login:function(e,t){return o=>{var n;o((n={email:e},{type:s.A.LOGIN_REQUEST,user:n})),r.login(e,t).then((e=>{o(function(e){return{type:s.A.LOGIN_SUCCESS,user:e}}(e.token)),o({type:s.A.GETUSER_SUCCESS,user:e}),h.m.push("/")}),(e=>{o(function(e){return{type:s.A.LOGIN_FAILURE,error:e}}(e.toString())),o(l.I.error(e.toString()))}))}},logout:function(){return r.logout(),e=>{e({type:s.A.LOGOUT})}},register:function(e){return t=>{t(function(e){return{type:s.A.REGISTER_REQUEST,user:e}}(e)),r.register(e).then((e=>{t(function(e){return{type:s.A.REGISTER_SUCCESS,user:e}}()),h.m.push("/login"),t(l.I.success(e.message))}),(e=>{t(function(e){return{type:s.A.REGISTER_FAILURE,error:e}}(e.toString())),t(l.I.error(e.toString()))}))}},sendVerificationEmail:function(e){return t=>{r.sendVerificationEmail(e).then((e=>{t(l.I.success(e.message))}),(e=>{t(l.I.error(e))}))}},getUserData:function(e){return t=>{t({type:s.A.GETUSER_REQUEST}),r.getUserData(e).then((e=>{var o;e.user.posts&&e.user.posts.forEach((e=>t({type:n.q.INIT_COMMENT,postId:e._id}))),t((o=e.user,{type:s.A.GETUSER_SUCCESS,user:o}))}),(e=>{t(function(e){return{type:s.A.GETUSER_FAILURE,error:e}}(e.toString())),t(l.I.error(e.toString()))}))}},getUserProfileFollowers:function(e){return t=>{r.getUserProfileFollowers(e).then((e=>{var o;t((o=e.users[0].followers,{type:s.A.GET_USER_PROFILE_FOLLOWERS,users:o}))}),(e=>{console.log(e)}))}},getUserProfileFollowings:function(e){return t=>{r.getUserProfileFollowings(e).then((e=>{var o;t((o=e.users[0].following,{type:s.A.GET_USER_PROFILE_FOLLOWINGS,users:o}))}),(e=>{console.log(e)}))}},getFollowers:function(e){return t=>{r.getUserProfileFollowers(e).then((e=>{var o;t((o=e.users[0].followers,{type:s.A.GET_USER_FOLLOWERS,users:o}))}),(e=>{console.log(e)}))}},getPosts:function(e){return t=>{r.getPosts(e).then((e=>{var o;e.posts.forEach((e=>t({type:n.q.INIT_COMMENT,postId:e._id}))),t((o=e.posts,{type:s.A.GET_POSTS,posts:o}))}),(e=>{t(l.I.error(e))}))}},getUserPosts:function(e){return t=>{r.getPosts(e).then((e=>{var o;e.posts.forEach((e=>t({type:n.q.INIT_COMMENT,postId:e._id}))),t((o=e.posts,{type:s.A.GET_USER_PROFILE_POSTS,posts:o}))}),(e=>{t(l.I.error(e))}))}},getFollowings:function(e){return t=>{r.getUserProfileFollowings(e).then((e=>{var o;t((o=e.users[0].following,{type:s.A.GET_USER_FOLLOWINGS,users:o}))}),(e=>{console.log(e)}))}},updateUserData:function(e){return t=>{t({type:s.A.USER_UPDATE_REQUEST}),r.updateUser(e).then((e=>{t(function(e){return{type:s.A.USER_UPDATE_SUCCESS,user:e}}(e.user))}),(e=>{t(function(e){return{type:s.A.USER_UPDATE_FAILURE,error:e}}(e.toString()))}))}},followUser:function(e){return t=>{r.followUser(e).then((e=>{"followed"===e.action?t({type:s.A.FOLLOW_USER,user:e}):t({type:s.A.UNFOLLOW_USER,user:e})}),(e=>{console.log(e)}))}},sendforgotPasswordEmail:function(e){return t=>{r.sendforgotPasswordEmail(e).then((e=>{t(l.I.success(e.message))}),(e=>{t(l.I.error(e))}))}},getUserProfileData:function(e){return t=>{t({type:s.A.GET_USERPROFILE_DATA_REQUEST}),r.getUserProfileData(e).then((e=>{if(e.user.loggedInUser)return h.m.push("/profile");var o;document.title="@"+e.user.username+" | social-network",t((o=e,{type:s.A.GET_USERPROFILE_DATA,user:o})),e.user.posts&&e.user.posts.forEach((e=>t({type:n.q.INIT_COMMENT,postId:e._id})))}),(e=>{console.log(e),t({type:s.A.GET_USERPROFILE_DATA_FAILURE}),t(l.I.error(e.toString()))}))}},getNewUsers:function(e){return t=>{e.initialFetch||t({type:s.A.GET_NEW_USERS_REQUEST}),r.getNewUsers(e).then((o=>{var n;t((n={...o,...e},{type:s.A.GET_NEW_USERS_SUCCESS,data:n}))}),(e=>{console.log(e)}))}},resetPassword:function(e){return o=>{o({type:s.A.PASSWORD_RESET_REQUEST}),r.resetPassword(e).then((e=>{o(l.I.success(e.message)),o(t())}),(e=>{o(l.I.error(e)),o(t())}))};function t(){return{type:s.A.PASSWORD_RESET_RESPONSE}}}}},12444:(e,t,o)=>{o.d(t,{e:()=>a});o(72791);var s=o(40834),n=o(66826),r=o(76915),i=o(72898);const a=(0,n.$j)((e=>({user:e.user.data})))((function(e){let{userId:t,user:o,dispatch:n}=e;const a=()=>{n(r.h.followUser(t))};return o._id===t?null:o.followingIds.some((e=>e===t))?(0,i.jsx)(s.Z,{className:"btn profile-edit-btn",basic:!0,color:"grey",onClick:a,fluid:!0,children:"unfollow"}):(0,i.jsx)(s.Z,{className:"btn profile-edit-btn",primary:!0,onClick:a,fluid:!0,children:"follow"})}))},59129:(e,t,o)=>{o.d(t,{Z:()=>c});o(72791);var s=o(78417),n=o(93825),r=o(50796),i=o(12444),a=o(72898);function c(e){let{user:{_id:t,username:o,profilePicture:c}}=e;return(0,a.jsxs)(n.Z.Item,{children:[(0,a.jsx)(n.Z.Content,{floated:"right",children:(0,a.jsx)(i.e,{userId:t})}),(0,a.jsx)(r.Z,{avatar:!0,src:"/images/profile-picture/100x100/".concat(c)}),(0,a.jsx)(n.Z.Content,{as:s.Z,to:"/"+o,style:{color:"#3d3d3d"},children:o})]})}},52970:(e,t,o)=>{o.d(t,{Z:()=>oe});var s=o(72791),n=o(62836),r=o(47823),i=o(40834),a=o(2178),c=o(70899),l=o(50796),h=o(66826),p=o(82288),u=o(52675),d=o(51935);const m={addComment:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({...e})};return fetch("/api/comment/addComment/",t).then(S).then((e=>e))},getPostComments:function(e,t){const o={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({postId:e,...t})};return fetch("/api/comment/getComments/",o).then(S).then((e=>e))},logout:g,addCommentReply:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({...e})};return fetch("/api/comment/addCommentReply/",t).then(S).then((e=>e))},getCommentReplies:function(e,t){const o={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({commentId:e,...t})};return fetch("/api/comment/getCommentReplies/",o).then(S).then((e=>e))},getCommentLikes:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({commentId:e})};return fetch("/api/comment/getCommentLikes/",t).then(S).then((e=>e))},getCommentReplyLikes:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({commentId:e})};return fetch("/api/comment/getCommentReplyLikes/",t).then(S).then((e=>e))},likeComment:function(e){delete e.commentLikes;const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({...e})};return fetch("/api/comment/likeComment/",t).then(S).then((e=>e))},likeCommentReply:function(e){delete e.commentReplyLikes;const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({...e})};return fetch("/api/comment/likeCommentReply/",t).then(S).then((e=>e))}};function g(){localStorage.removeItem("user")}function S(e){return e.text().then((t=>{const o=t&&JSON.parse(t);if(!e.ok){401===e.status&&(g(),window.location.reload(!0));const t=o&&o.message||e.statusText;return Promise.reject(t)}return o}))}const f={addComment:function(e){return t=>{m.addComment(e).then((e=>{var o;t({type:u.X.INIT_REPLY_COMMENT,commentId:e.comment._id}),t((o=e.comment,{type:u.X.ADD_COMMENT_SUCCESS,comment:o}))}),(e=>{console.log(e)}))}},getPostComments:function(e,t){return o=>{o(function(e){return{type:u.X.FETCH_COMMENTS_REQUEST,postId:e}}(e)),m.getPostComments(e,t).then((e=>{e.comments.forEach((e=>{o({type:u.X.INIT_REPLY_COMMENT,commentId:e._id})})),o(function(e,t){return{type:u.X.FETCH_COMMENTS_SUCCESS,comment:e,queryOptions:t}}(e,t))}),(e=>{console.log(e)}))}},getCommentLikes:function(e){return t=>{m.getCommentLikes(e).then((e=>{var o;t((o=e.users[0].users_likes,{type:u.X.GET_COMMENT_LIKES,commentLikes:o}))}),(e=>{console.log(e)}))}},getCommentReplyLikes:function(e){return t=>{m.getCommentReplyLikes(e).then((e=>{var o;t((o=e.users[0].users_likes,{type:u.X.GET_COMMENT_REPLY_LIKES,commentLikes:o}))}),(e=>{console.log(e)}))}},addCommentReply:function(e){return t=>{const{commentId:o,postId:s}=e;m.addCommentReply(e).then((e=>{var n;t({type:u.X.INCREASE_REPLIES_NUMBER,commentId:o,postId:s}),t((n=e.comment,{type:u.X.ADD_REPLY_COMMENT_SUCCESS,comment:n}))}),(e=>{console.log(e)}))}},getPostCommentReplies:function(e,t){return o=>{o(function(e){return{type:u.X.FETCH_COMMENT_REPLIES_REQUEST,commentId:e}}(e)),m.getCommentReplies(e,t).then((e=>{o(function(e){return{type:u.X.FETCH_COMMENT_REPLIES_SUCCESS,comment:e}}(e))}),(e=>{console.log(e)}))}},likeComment:function(e){return o=>{const{commentId:s,postId:n,commentLikes:r}=e;r.some((e=>e===s))?(o(t(u.X.DISLIKE_COMMENT,{commentId:s,postId:n})),o(t(d.A.USER_DISLIKE_COMMENT,{commentId:s,postId:n}))):(o(t(u.X.LIKE_COMMENT,{commentId:s,postId:n})),o(t(d.A.USER_LIKE_COMMENT,{commentId:s,postId:n}))),m.likeComment(e).then((()=>{}),(e=>{console.log(e)}))};function t(e,t){return{type:e,comment:t}}},likeCommentReply:function(e){return o=>{const{commentId:s,commentAt:n,commentReplyLikes:r}=e;r.some((e=>e===s))?(o(t(u.X.DISLIKE_COMMENT_REPLY,{commentId:s,parentId:n})),o(t(d.A.USER_DISLIKE_COMMENT_REPLY,{commentId:s,parentId:n}))):(o(t(u.X.LIKE_COMMENT_REPLY,{commentId:s,parentId:n})),o(t(d.A.USER_LIKE_COMMENT_REPLY,{commentId:s,parentId:n}))),m.likeCommentReply(e).then((()=>{}),(e=>{console.log(e)}))};function t(e,t){return{type:e,comment:t}}}};var y=o(95986),I=o(62966),E=o(72447),C=o(78417),T=o(93825),_=o(59129),O=o(72898);const x=(0,h.$j)((e=>({commentReplyLikes:e.user.data.commentReplyLikes,commentLikeList:e.replies.commentLikes})))((e=>{let{dispatch:t,comment:{commentId:o,likes:i,commentAt:a,authorId:c},post:{postId:l},commentReplyLikes:h,commentLikeList:p}=e;const u=p.length?p.map((e=>{let{author:t}=e;return(0,O.jsx)(_.Z,{user:t},t._id)})):null;return(0,O.jsxs)(s.Fragment,{children:[(0,O.jsxs)(r.Z,{trigger:(0,O.jsx)("span",{style:{cursor:"pointer",marginRight:"3px"},onClick:()=>{t(f.getCommentReplyLikes(o))},children:i}),onClose:()=>{t({type:"CLEAR_COMMENT_REPLY_LIKES"})},children:[(0,O.jsx)(r.Z.Header,{children:"Likes"}),(0,O.jsx)(r.Z.Content,{scrolling:!0,children:(0,O.jsx)(r.Z.Description,{children:(0,O.jsx)(T.Z,{verticalAlign:"middle",size:"huge",children:u})})})]}),(0,O.jsxs)(y.Z.Action,{onClick:()=>{t(f.likeCommentReply({commentId:o,commentAt:a,authorId:c,postId:l,commentReplyLikes:h}))},children:[h.some((e=>e===o))?(0,O.jsx)(n.Z,{style:{color:"#ed4956"},name:"heart"}):(0,O.jsx)(n.Z,{name:"heart"}),"Like"]})]})}));var j=o(11589),P=o.n(j),N=o(58612),k=o(97202),L=o.n(k),A=o(47749),R=o.n(A),U=o(97892),v=o.n(U),b=o(40130),Z=o.n(b);v().extend(Z()),L()(N),R()(N);const w={formatHref:function(e,t){return"hashtag"===t&&(e="/hashtags/"+e.substring(1)),"mention"===t&&(e="/"+e.substring(1)),e},attributes:{target:{url:"_blank"}}},F=(0,h.$j)((e=>({username:e.user.data.username})))((e=>{let{username:t,comment:o,post:{postId:s,photo:n}}=e;return(0,O.jsxs)(y.Z,{children:[(0,O.jsx)(y.Z.Avatar,{src:"/images/profile-picture/100x100/".concat(o.author[0].profilePicture)}),(0,O.jsxs)(y.Z.Content,{children:[(0,O.jsx)(y.Z.Author,{as:C.Z,to:o.author[0].username===t?"/profile":"/"+o.author[0].username,children:o.author[0].firstName+" "+o.author[0].lastName}),(0,O.jsx)(y.Z.Metadata,{children:(0,O.jsx)("div",{children:v()(o.createdAt).fromNow()})}),(0,O.jsx)(y.Z.Text,{style:{whiteSpace:"pre-line"},children:(0,O.jsx)(P(),{options:w,children:o.text})}),(0,O.jsx)(y.Z.Actions,{children:(0,O.jsx)(x,{comment:{commentId:o._id,commentText:o.text,likes:o.likes,authorId:o.author[0]._id,commentAt:o.commentAt},post:{postId:s,photo:n}})})]})]})}));class J extends s.Component{constructor(){super(...arguments),this.state={collapsed:!0},this.handleCheckbox=()=>{const{dispatch:e,replies:t,comment:{commentId:o}}=this.props;t[o].comments.length||t[o].fetching||e(f.getPostCommentReplies(o,{initialFetch:!0})),this.setState({collapsed:!this.state.collapsed})},this.fetchReplies=()=>{const{dispatch:e,replies:t,comment:{commentId:o}}=this.props;if(!t[o].fetching){const s=t[o].comments[t[o].comments.length-1]._id;e(f.getPostCommentReplies(o,{initialFetch:!1,lastId:s}))}}}render(){const{collapsed:e}=this.state,{replies:t,comment:{commentId:o,repliesNum:r},post:a}=this.props;let c=null;const l=r!==t[o].comments.length,h=t[o].fetching;return t[o].comments.length&&(c=t[o].comments.map((e=>(0,O.jsx)(F,{comment:e,post:a},e._id)))),(0,O.jsxs)(s.Fragment,{children:[0!==r?(0,O.jsxs)("div",{onClick:()=>this.handleCheckbox(),style:{cursor:"pointer",margin:"20px 0 20px"},children:[(0,O.jsx)(n.Z,{name:"arrow down"})," ",e?r+" replies":"Show less"]}):null,(0,O.jsxs)(y.Z.Group,{collapsed:e,children:[c,l?(0,O.jsxs)(s.Fragment,{children:[(0,O.jsx)(I.Z,{}),(0,O.jsxs)(i.Z,{loading:h,onClick:this.fetchReplies,children:["Load ",r-t[o].comments.length," more"]})]}):null]})]})}}const M=(0,h.$j)((e=>({replies:e.replies})))(J),D=(0,h.$j)((e=>({commentLikes:e.user.data.commentLikes,commentLikeList:e.comments.commentLikes})))((e=>{let{dispatch:t,comment:{commentId:o,likes:i,authorId:a},commentLikes:c,post:{postId:l},commentLikeList:h}=e;const p=h.length?h.map((e=>{let{author:t}=e;return(0,O.jsx)(_.Z,{user:t},t._id)})):null;return(0,O.jsxs)(s.Fragment,{children:[(0,O.jsxs)(r.Z,{trigger:(0,O.jsx)("span",{style:{cursor:"pointer",marginRight:"3px"},onClick:()=>{t(f.getCommentLikes(o))},children:i}),onClose:()=>{t({type:"CLEAR_COMMENT_LIKES"})},children:[(0,O.jsx)(r.Z.Header,{children:"Likes"}),(0,O.jsx)(r.Z.Content,{scrolling:!0,children:(0,O.jsx)(r.Z.Description,{children:(0,O.jsx)(T.Z,{verticalAlign:"middle",size:"huge",children:p})})})]}),(0,O.jsxs)(y.Z.Action,{onClick:()=>{t(f.likeComment({commentId:o,authorId:a,postId:l,commentLikes:c}))},children:[c.some((e=>e===o))?(0,O.jsx)(n.Z,{style:{color:"#ed4956"},name:"heart"}):(0,O.jsx)(n.Z,{name:"heart"}),"Like"]})]})}));var G=o(3982),q=o.n(G),z=(o(65568),o(86559));v().extend(Z()),L()(N),R()(N);const H={formatHref:function(e,t){return"hashtag"===t&&(e="/hashtags/"+e.substring(1)),"mention"===t&&(e="/"+e.substring(1)),e},attributes:{target:{url:"_blank"}}};class K extends s.Component{constructor(){super(),this.handleChange=e=>{this.setState({replyText:e})},this.handleRequestOptions=e=>{this.setState({part:e}),""!==e&&function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({q:e})};return fetch("/api/user/searchByUsername",t).then((e=>e))}(e).then((t=>{e===this.state.part?t.json().then((e=>{this.setState({isLoading:!1,suggestions:e.users.map((e=>e.username))})})):this.setState({isLoading:!1})}))},this.handleFormToggle=()=>{this.setState({isOpen:!this.state.isOpen})},this.handleSubmit=()=>{const{dispatch:e,post:t,comment:o}=this.props,{replyText:s}=this.state;""!==s&&(e(f.addCommentReply({text:s,commentId:o._id,postId:t.postId,authorId:o.author[0]._id})),this.setState({replyText:"",isOpen:!1}))},this.state={isOpen:!1,replyText:"",part:"",suggestions:[]},this.debouncedRequestOptions=(0,z.D)(500,this.handleRequestOptions)}render(){const{post:e,comment:t,username:o}=this.props,{isOpen:s,replyText:n,suggestions:r}=this.state;return(0,O.jsxs)(y.Z,{children:[(0,O.jsx)(y.Z.Avatar,{src:"/images/profile-picture/100x100/".concat(t.author[0].profilePicture)}),(0,O.jsxs)(y.Z.Content,{children:[(0,O.jsx)(y.Z.Author,{as:C.Z,to:t.author[0].username===o?"/profile":"/"+t.author[0].username,children:t.author[0].firstName+" "+t.author[0].lastName}),(0,O.jsx)(y.Z.Metadata,{children:(0,O.jsx)("div",{children:v()(t.createdAt).fromNow()})}),(0,O.jsx)(y.Z.Text,{style:{whiteSpace:"pre-line"},children:(0,O.jsx)(P(),{options:H,children:t.text})}),(0,O.jsxs)(y.Z.Actions,{children:[(0,O.jsx)(y.Z.Action,{onClick:()=>this.handleFormToggle(),children:"Reply"}),(0,O.jsx)(D,{comment:{commentId:t._id,commentText:t.text,likes:t.likes,authorId:t.author[0]._id},post:{postId:e.postId,photo:e.photo}})]}),s?(0,O.jsxs)(E.Z,{reply:!0,onSubmit:()=>this.handleSubmit(),children:[(0,O.jsx)(q(),{maxOptions:8,offsetY:20,minChars:1,value:n,onRequestOptions:this.debouncedRequestOptions,options:r,onChange:this.handleChange,type:"textarea",name:"replyText",style:{marginBottom:"1%"}}),(0,O.jsx)(i.Z,{content:"Add Reply",labelPosition:"left",icon:"edit",primary:!0})]}):null]}),(0,O.jsx)(M,{comment:{commentId:t._id,repliesNum:t.replies},post:{postId:e.postId,photo:e.photo}})]})}}const X=(0,h.$j)((e=>({username:e.user.data.username})))(K);class B extends s.Component{constructor(){super(...arguments),this.state={commentText:""},this.handleScroll=(e,t)=>{e.target.scrollHeight-e.target.scrollTop===e.target.clientHeight&&t&&this.fetchData()},this.fetchData=()=>{const{dispatch:e,post:t,comments:o}=this.props;if(!o[t.postId].fetching){const s=o[t.postId].comments[o[t.postId].comments.length-1]._id;e(f.getPostComments(t.postId,{initialFetch:!1,lastId:s}))}}}render(){const{post:e,comments:t}=this.props;if(t[e.postId]){const o=t[e.postId].comments,n=o.length!==e.commentsCount,r=o.map((t=>(0,O.jsx)(X,{comment:t,post:e},t._id))),a=t[e.postId].fetching;return(0,O.jsx)("div",{className:"post-comments",children:(0,O.jsxs)(y.Z.Group,{size:"large",onScroll:e=>this.handleScroll(e,n),style:{overflow:"auto",maxHeight:"600px"},children:[a?(0,O.jsx)("p",{children:"loading..."}):null,r.length?r:null,o.length&&n?(0,O.jsxs)(s.Fragment,{children:[(0,O.jsx)(I.Z,{}),(0,O.jsxs)(i.Z,{loading:a,onClick:this.fetchData,children:["Load ",e.commentsCount-o.length," more"]})]}):null]})})}return null}}const Q=(0,h.$j)((e=>({comments:e.comments})))(B),Y=(0,h.$j)((e=>({postLikes:e.user.data.postLikes,postLikeList:e.post.postLikes})))((e=>{let{dispatch:t,post:{postId:o,likes:i,authorId:a},postLikes:c,postLikeList:l}=e;const h=()=>{t(p.r.likePost(o,a,c))},u=l.length?l.map((e=>{let{author:t}=e;return(0,O.jsx)(_.Z,{user:t},t._id)})):null;return(0,O.jsxs)(s.Fragment,{children:[c.some((e=>e===o))?(0,O.jsx)(n.Z,{onClick:h,style:{color:"#ed4956",cursor:"pointer"},name:"heart",className:"heart-icon"}):(0,O.jsx)(n.Z,{onClick:h,style:{cursor:"pointer"},name:"heart outline",className:"heart-icon"}),(0,O.jsxs)(r.Z,{trigger:(0,O.jsx)("span",{style:{cursor:"pointer"},onClick:()=>{t(p.r.getPostLikes(o))},children:i}),onClose:()=>{t({type:"CLEAR_POST_LIKES"})},children:[(0,O.jsx)(r.Z.Header,{children:"Likes"}),(0,O.jsx)(r.Z.Content,{scrolling:!0,children:(0,O.jsx)(r.Z.Description,{children:(0,O.jsx)(T.Z,{verticalAlign:"middle",size:"huge",children:u})})})]})]})}));class V extends s.Component{constructor(){super(),this.handleChange=e=>{this.setState({value:e})},this.handleRequestOptions=e=>{this.setState({part:e}),""!==e&&function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({q:e})};return fetch("/api/user/searchByUsername",t).then((e=>e))}(e).then((t=>{e===this.state.part?t.json().then((e=>{this.setState({isLoading:!1,suggestions:e.users.map((e=>e.username))})})):this.setState({isLoading:!1})}))},this.handlePostCommentSubmit=()=>{const{dispatch:e,post:{postId:t,authorId:o}}=this.props,{value:s}=this.state;""!==s&&(e(f.addComment({value:s,postId:t,authorId:o})),this.setState({value:""}))},this.state={value:"",part:"",suggestions:[]},this.debouncedRequestOptions=(0,z.D)(500,this.handleRequestOptions)}render(){const{value:e,suggestions:t}=this.state;return(0,O.jsxs)(E.Z,{reply:!0,onSubmit:this.handlePostCommentSubmit,children:[(0,O.jsx)(q(),{maxOptions:8,offsetY:20,minChars:1,value:e,onRequestOptions:this.debouncedRequestOptions,options:t,onChange:this.handleChange,type:"textarea",name:"commentText",style:{minHeight:70,maxHeight:70,marginBottom:"1%"}}),(0,O.jsx)(i.Z,{content:"Add Comment",labelPosition:"left",icon:"edit",primary:!0})]})}}const W=(0,h.$j)(null)(V);var $=o(74325);v().extend(Z()),L()(N),R()(N);const ee={formatHref:function(e,t){return"hashtag"===t&&(e="/hashtags/"+e.substring(1)),"mention"===t&&(e="/"+e.substring(1)),e},attributes:{target:{url:"_blank"}}};class te extends s.Component{constructor(){super(...arguments),this.state={open:!1,loadedImg:!1,value:"",showTags:!1,optionsLoggedIn:[{key:"copy",icon:"copy",text:"Copy link",value:"copy"},{key:"goto",icon:"paper plane outline",text:"Go to post",value:"goto"},{key:"delete",icon:"delete",text:"Delete",value:"delete"}],optionsNotLoggedIn:[{key:"copy",icon:"copy",text:"Copy link",value:"copy"},{key:"goto",icon:"paper plane outline",text:"Go to post",value:"goto"}]},this.close=()=>this.setState({open:!1,value:""}),this.handleToggleTags=()=>{this.setState({showTags:!this.state.showTags})},this.getPostComments=()=>{const{dispatch:e,post:t,comments:o}=this.props;o[t._id].comments.length||o[t._id].fetching||!t.comments||e(f.getPostComments(t._id,{initialFetch:!0}))},this.deletePost=()=>{const{dispatch:e,post:t}=this.props;e(p.r.deletePost(t._id))},this.handleChange=(e,t)=>{let{name:o,value:s}=t;this.setState({value:s,open:!1}),"goto"===s&&($.m.push("/p/"+this.props.post._id),this.setState({value:s,open:!1})),"delete"===s&&this.setState({value:s,open:!0}),"copy"===s&&navigator.clipboard.writeText(window.location.host+"/p/"+this.props.post._id)},this.handleClose=()=>{this.setState({value:"",open:!1})}}render(){const{post:e,_id:t,username:o}=this.props,{open:h,optionsLoggedIn:p,optionsNotLoggedIn:u,value:d,showTags:m}=this.state,g=e.feed?"5rem":"0",S=e.tags.map((e=>(0,O.jsx)("div",{className:"text-box",style:{top:e.y+"%",left:e.x+"%",display:m?"block":"none"},children:(0,O.jsx)("div",{className:"tooltip tooltip-top",children:e.value===o?(0,O.jsx)(C.Z,{to:"/profile",children:e.value}):(0,O.jsx)(C.Z,{to:"/"+e.value,children:e.value})})},e.id))),f=e.tags.length?(0,O.jsx)("div",{className:"ribbon",children:(0,O.jsx)(n.Z,{circular:!0,size:"large",name:"users",style:{backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",display:m?"none":"block"}})}):null;return(0,O.jsxs)("div",{className:"post",style:{marginBottom:g},children:[(0,O.jsxs)("div",{className:"post-header",children:[(0,O.jsxs)("div",{className:"post-label",children:[(0,O.jsx)("div",{className:"label-image",children:(0,O.jsx)("img",{src:"/images/profile-picture/100x100/".concat(e.author[0].profilePicture),alt:""})}),(0,O.jsxs)("div",{className:"label-info",children:[(0,O.jsx)("div",{className:"label-username",children:(0,O.jsx)(C.Z,{to:e.author[0].username===o?"/profile":"/"+e.author[0].username,children:e.author[0].username})}),(0,O.jsx)("div",{className:"label-time",children:v()(e.createdAt).fromNow()})]}),e.location&&""!==e.location.address?(0,O.jsx)("div",{className:"label-location",children:(0,O.jsx)(C.Z,{to:"/location/".concat(e.location.coordinates[0],",").concat(e.location.coordinates[1]),children:e.location.address})}):null]}),(0,O.jsxs)("div",{className:"post-options",children:[(0,O.jsxs)(r.Z,{open:h,onClose:this.close,size:"tiny",children:[(0,O.jsx)(r.Z.Header,{children:"Delete Your Post"}),(0,O.jsx)(r.Z.Content,{children:(0,O.jsx)("p",{children:"Are you sure you want to delete your post"})}),(0,O.jsxs)(r.Z.Actions,{children:[(0,O.jsx)(i.Z,{negative:!0,onClick:this.close,children:"No"}),(0,O.jsx)(i.Z,{positive:!0,icon:"checkmark",labelPosition:"right",content:"Yes",onClick:this.deletePost})]})]}),e.author[0]._id===t?(0,O.jsx)(i.Z.Group,{children:(0,O.jsx)(a.Z,{selectOnNavigation:!1,onChange:this.handleChange,value:d,className:"button icon",floating:!0,options:p,trigger:(0,O.jsx)(s.Fragment,{})})}):(0,O.jsx)(i.Z.Group,{children:(0,O.jsx)(a.Z,{selectOnNavigation:!1,onChange:this.handleChange,value:d,className:"button icon",floating:!0,options:u,trigger:(0,O.jsx)(s.Fragment,{})})})]})]}),(0,O.jsxs)("div",{className:"post-image",children:[this.state.loadedImg?null:(0,O.jsx)(c.Z,{loading:!0,children:(0,O.jsx)(l.Z,{src:"/images/post-images/thumbnail/".concat(e.photo)})}),(0,O.jsx)("img",{onClick:this.handleToggleTags,onLoad:()=>this.setState({loadedImg:!0}),style:this.state.loadedImg?{}:{display:"none"},src:"/images/post-images/".concat(e.photo),alt:""}),f,S]}),e.description?(0,O.jsx)("div",{className:"post-description",children:(0,O.jsx)(P(),{options:ee,children:e.description})}):null,(0,O.jsxs)("div",{className:"post-footer",children:[(0,O.jsx)("div",{className:"footer-likes",children:(0,O.jsx)(Y,{post:{postId:e._id,photo:e.photo,authorId:e.author[0]._id,likes:e.likes}})}),(0,O.jsxs)("div",{className:"footer-comments",children:[(0,O.jsx)(n.Z,{name:"comment outline",style:{cursor:"pointer"},onClick:this.getPostComments}),(0,O.jsx)("div",{children:e.comments})]})]}),(0,O.jsx)(Q,{post:{postId:e._id,commentsCount:e.comments,photo:e.photo,authorId:e.author[0]._id}}),(0,O.jsx)("div",{className:"post-form",children:(0,O.jsx)(W,{post:{postId:e._id,authorId:e.author[0]._id,photo:e.photo}})})]})}}const oe=(0,h.$j)((e=>{const{_id:t,username:o}=e.user.data;return{_id:t,username:o,comments:e.comments}}))(te)}}]);
//# sourceMappingURL=970.6905db05.chunk.js.map