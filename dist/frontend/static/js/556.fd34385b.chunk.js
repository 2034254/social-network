(self.webpackChunksocial_network_client=self.webpackChunksocial_network_client||[]).push([[556],{84697:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});class s{constructor(){this.stream=null}getPremissions(){return new Promise(((e,t)=>{navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((t=>{this.stream=t,e(t)})).catch((e=>{throw new Error("Unable to fetch stream "+e)}))}))}stopRecoring(){this.stream.getTracks().forEach((function(e){e.stop()}))}}},17531:(e,t,n)=>{"use strict";n.d(t,{O:()=>i});var s=n(67035);const o={getChatRooms:function(){const e={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token}};return fetch("/api/chat/getChatRooms/",e).then(r).then((e=>e))},getMessagesForRoom:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({...e})};return fetch("/api/chat/getMessagesForRoom/",t).then(r).then((e=>e))},sendMessage:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({...e})};return fetch("/api/chat/sendMessage/",t).then(r).then((e=>e))},sendImage:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token},body:e};return fetch("/api/chat/sendImage/",t).then(r).then((e=>e))},readMessages:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({...e})};return fetch("/api/chat/readMessages/",t).then(r).then((e=>e))},call:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({...e})};return fetch("/api/chat/call/",t).then(r).then((e=>e))},answer:function(e){const t={method:"POST",headers:{"Content-Type":"application/json",Authorization:JSON.parse(localStorage.getItem("user")).token},body:JSON.stringify({...e})};return fetch("/api/chat/answer/",t).then(r).then((e=>e))}};function r(e){return e.text().then((t=>{const n=t&&JSON.parse(t);if(!e.ok){401===e.status&&(localStorage.removeItem("user"),window.location.reload(!0));const t=n&&n.message||e.statusText;return Promise.reject(t)}return n}))}const i={typing:function(e){return t=>{t({type:s.q.TYPING,roomId:e})}},stoppedTyping:function(e){return t=>{t({type:s.q.STOPPED_TYPING,roomId:e})}},changeRoom:function(e){return t=>{t({type:s.q.CHANGE_ROOM,room:e})}},getChatRooms:function(){return e=>{e({type:s.q.GET_ROOMS_REQUEST}),o.getChatRooms().then((t=>{var n;e((n=t.rooms,{type:s.q.GET_ROOMS_SUCCESS,rooms:n})),t.rooms.forEach((t=>{return e((n=t._id,{type:s.q.INIT_MESSAGE_ARRAY,roomId:n}));var n}))}),(e=>{console.log(e)}))}},getMessagesForRoom:function(e){return t=>{var n;e.initialFetch?t((n=e._id,{type:s.q.GET_MESSAGES_INITIAL_REQUEST,roomId:n})):t(function(e){return{type:s.q.GET_MESSAGES_REQUEST,roomId:e}}(e._id)),o.getMessagesForRoom(e).then((n=>{var o;t((o={messages:n.messages.reverse(),roomId:e._id},{type:s.q.GET_MESSAGES_SUCCESS,data:o}))}),(e=>{console.log(e)}))}},sendMessage:function(e){return t=>{t(function(e){return{type:s.q.SEND_MESSAGE_REQUEST,message:e}}({...e,sent:!1})),o.sendMessage(e).then((e=>{t(function(e){return{type:s.q.SEND_MESSAGE_SUCCESS,message:e}}(e.message))}),(e=>{console.log(e)}))}},sendImage:function(e,t){return n=>{n(function(e){return{type:s.q.SEND_MESSAGE_REQUEST,message:e}}({...t,sent:!1})),o.sendImage(e).then((e=>{n(function(e){return{type:s.q.SEND_MESSAGE_SUCCESS,message:e}}(e.message))}),(e=>{console.log(e)}))}},newMessage:function(e){return t=>{t(function(e){return{type:s.q.NEW_MESSAGE,message:e}}(e)),t({type:s.q.INC_MESSAGE_COUNT})}},readMessages:function(e){const{messageIds:t,roomId:n}=e;return r=>{r(function(e,t){return{type:s.q.READ_MESSAGES,messageIds:e,roomId:t}}(t,n)),o.readMessages(e).then((()=>{}),(e=>{console.log(e)}))}},changeActivityStatus:function(e){return t=>{t({type:s.q.CHANGE_ACTIVITY_STATUS,user:e})}},imageMessageRequest:function(e){return t=>{t(function(e){return{type:s.q.NEW_IMAGE_MESSAGE_REQUEST,message:e}}(e))}},call:function(e){return t=>{t({type:s.q.OPEN_CALLING_MODAL}),o.call(e).then((()=>{}),(e=>{console.log(e)}))}},answer:function(e){return t=>{o.answer(e).then((()=>{}),(e=>{console.log(e)}))}},endCall:function(){return e=>{e({type:s.q.CLOSE_CALLING_MODAL})}},endAnsweringCall:function(){return e=>{e({type:s.q.CLOSE_ANSWERING_MODAL})}},searchUsers:function(e){return t=>{t({type:s.q.SEARCH_USERS,rooms:e})}}}},76915:(e,t,n)=>{"use strict";n.d(t,{h:()=>h});var s=n(51935),o=n(73685);const r={login:function(e,t){const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})};return fetch("/api/user/login",n).then(a).then((e=>(localStorage.setItem("user",JSON.stringify({token:e.user.token})),e.user)))},logout:i,sendVerificationEmail:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})};return fetch("/api/user/sendVerificationEmail/",t).then(a)},sendforgotPasswordEmail:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})};return fetch("/api/user/sendforgotPasswordEmail/",t).then(a)},register:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("/api/user/signup/",t).then(a)},getUserData:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/getUserData",t).then(a).then((e=>e))},resetPassword:function(e){const t={method:"POST",headers:{Authorization:"Bearer "+e.jwt,"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/passwordreset",t).then(c).then((e=>e))},updateUser:function(e){delete e.isDisabled;const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("/api/user/updateUser",t).then(a).then((e=>(localStorage.setItem("user",JSON.stringify({token:e.token})),e)))},followUser:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({userId:e})};return fetch("/api/user/followUser",t).then(a).then((e=>e))},getUserProfileData:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({username:e.trim(),profilePage:!0})};return fetch("/api/user/getProfilePageData",t).then(a).then((e=>e))},getPosts:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/getPosts",t).then(a).then((e=>e))},getUserProfileFollowers:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({userId:e})};return fetch("/api/user/getUserProfileFollowers",t).then(a).then((e=>e))},getUserProfileFollowings:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({userId:e})};return fetch("/api/user/getUserProfileFollowings",t).then(a).then((e=>e))},getNewUsers:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/getNewUsers",t).then(a).then((e=>e))}};function i(){localStorage.removeItem("user")}function a(e){return e.text().then((t=>{const n=t&&JSON.parse(t);if(!e.ok){401===e.status&&(i(),window.location.reload(!0));const t=n&&n.message||e.statusText;return Promise.reject(t)}return n}))}function c(e){return e.text().then((t=>{const n=t&&JSON.parse(t);if(!e.ok){e.status;const t=n&&n.message||e.statusText;return Promise.reject(t)}return n}))}var l=n(44102),u=n(74325);const h={login:function(e,t){return n=>{var o;n((o={email:e},{type:s.A.LOGIN_REQUEST,user:o})),r.login(e,t).then((e=>{n(function(e){return{type:s.A.LOGIN_SUCCESS,user:e}}(e.token)),n({type:s.A.GETUSER_SUCCESS,user:e}),u.m.push("/")}),(e=>{n(function(e){return{type:s.A.LOGIN_FAILURE,error:e}}(e.toString())),n(l.I.error(e.toString()))}))}},logout:function(){return r.logout(),e=>{e({type:s.A.LOGOUT})}},register:function(e){return t=>{t(function(e){return{type:s.A.REGISTER_REQUEST,user:e}}(e)),r.register(e).then((e=>{t(function(e){return{type:s.A.REGISTER_SUCCESS,user:e}}()),u.m.push("/login"),t(l.I.success(e.message))}),(e=>{t(function(e){return{type:s.A.REGISTER_FAILURE,error:e}}(e.toString())),t(l.I.error(e.toString()))}))}},sendVerificationEmail:function(e){return t=>{r.sendVerificationEmail(e).then((e=>{t(l.I.success(e.message))}),(e=>{t(l.I.error(e))}))}},getUserData:function(e){return t=>{t({type:s.A.GETUSER_REQUEST}),r.getUserData(e).then((e=>{var n;e.user.posts&&e.user.posts.forEach((e=>t({type:o.q.INIT_COMMENT,postId:e._id}))),t((n=e.user,{type:s.A.GETUSER_SUCCESS,user:n}))}),(e=>{t(function(e){return{type:s.A.GETUSER_FAILURE,error:e}}(e.toString())),t(l.I.error(e.toString()))}))}},getUserProfileFollowers:function(e){return t=>{r.getUserProfileFollowers(e).then((e=>{var n;t((n=e.users[0].followers,{type:s.A.GET_USER_PROFILE_FOLLOWERS,users:n}))}),(e=>{console.log(e)}))}},getUserProfileFollowings:function(e){return t=>{r.getUserProfileFollowings(e).then((e=>{var n;t((n=e.users[0].following,{type:s.A.GET_USER_PROFILE_FOLLOWINGS,users:n}))}),(e=>{console.log(e)}))}},getFollowers:function(e){return t=>{r.getUserProfileFollowers(e).then((e=>{var n;t((n=e.users[0].followers,{type:s.A.GET_USER_FOLLOWERS,users:n}))}),(e=>{console.log(e)}))}},getPosts:function(e){return t=>{r.getPosts(e).then((e=>{var n;e.posts.forEach((e=>t({type:o.q.INIT_COMMENT,postId:e._id}))),t((n=e.posts,{type:s.A.GET_POSTS,posts:n}))}),(e=>{t(l.I.error(e))}))}},getUserPosts:function(e){return t=>{r.getPosts(e).then((e=>{var n;e.posts.forEach((e=>t({type:o.q.INIT_COMMENT,postId:e._id}))),t((n=e.posts,{type:s.A.GET_USER_PROFILE_POSTS,posts:n}))}),(e=>{t(l.I.error(e))}))}},getFollowings:function(e){return t=>{r.getUserProfileFollowings(e).then((e=>{var n;t((n=e.users[0].following,{type:s.A.GET_USER_FOLLOWINGS,users:n}))}),(e=>{console.log(e)}))}},updateUserData:function(e){return t=>{t({type:s.A.USER_UPDATE_REQUEST}),r.updateUser(e).then((e=>{t(function(e){return{type:s.A.USER_UPDATE_SUCCESS,user:e}}(e.user))}),(e=>{t(function(e){return{type:s.A.USER_UPDATE_FAILURE,error:e}}(e.toString()))}))}},followUser:function(e){return t=>{r.followUser(e).then((e=>{"followed"===e.action?t({type:s.A.FOLLOW_USER,user:e}):t({type:s.A.UNFOLLOW_USER,user:e})}),(e=>{console.log(e)}))}},sendforgotPasswordEmail:function(e){return t=>{r.sendforgotPasswordEmail(e).then((e=>{t(l.I.success(e.message))}),(e=>{t(l.I.error(e))}))}},getUserProfileData:function(e){return t=>{t({type:s.A.GET_USERPROFILE_DATA_REQUEST}),r.getUserProfileData(e).then((e=>{if(e.user.loggedInUser)return u.m.push("/profile");var n;document.title="@"+e.user.username+" | social-network",t((n=e,{type:s.A.GET_USERPROFILE_DATA,user:n})),e.user.posts&&e.user.posts.forEach((e=>t({type:o.q.INIT_COMMENT,postId:e._id})))}),(e=>{console.log(e),t({type:s.A.GET_USERPROFILE_DATA_FAILURE}),t(l.I.error(e.toString()))}))}},getNewUsers:function(e){return t=>{e.initialFetch||t({type:s.A.GET_NEW_USERS_REQUEST}),r.getNewUsers(e).then((n=>{var o;t((o={...n,...e},{type:s.A.GET_NEW_USERS_SUCCESS,data:o}))}),(e=>{console.log(e)}))}},resetPassword:function(e){return n=>{n({type:s.A.PASSWORD_RESET_REQUEST}),r.resetPassword(e).then((e=>{n(l.I.success(e.message)),n(t())}),(e=>{n(l.I.error(e)),n(t())}))};function t(){return{type:s.A.PASSWORD_RESET_RESPONSE}}}}},68285:(e,t,n)=>{"use strict";n.d(t,{L:()=>m});var s=n(72791),o=n(69986),r=n.n(o),i=n(78417),a=n(74325),c=n(86559),l=n(66826),u=n(72898);function h(e){let{username:t}=e;return t}function d(e){let{firstName:t,lastName:n,username:s,profilePicture:o}=e;return(0,u.jsx)(i.Z,{to:"/"+s,children:(0,u.jsxs)("span",{className:"suggestion-content "+s,children:[(0,u.jsx)("img",{alt:"",src:"/images/profile-picture/100x100/"+o}),(0,u.jsxs)("span",{className:"autosuggestion-name",children:[s,(0,u.jsx)("p",{children:"".concat(t," ").concat(n)})]})]})})}function p(e){let{firstName:t,lastName:n,username:s,profilePicture:o}=e;return(0,u.jsxs)("span",{className:"suggestion-content "+s,children:[(0,u.jsx)("img",{alt:"",src:"/images/profile-picture/100x100/"+o}),(0,u.jsxs)("span",{className:"autosuggestion-name",children:[s,(0,u.jsx)("p",{children:"".concat(t," ").concat(n)})]})]})}class g extends s.Component{constructor(){super(),this.onKeyDown=e=>{const{addTagPage:t}=this.props,{value:n}=this.state;13!==e.keyCode||t||""===n?13===e.keyCode&&t&&this.props.addAutocompleteTag(n):a.m.push("/".concat(n))},this.onChange=(e,t)=>{let{newValue:n}=t;const{addTagPage:s}=this.props;s&&this.props.handleChange(n),this.setState({value:n})},this.onSuggestionsFetchRequested=e=>{let{value:t}=e;this.debouncedLoadSuggestions(t)},this.onSuggestionsClearRequested=()=>{this.setState({suggestions:[]})},this.state={value:"",suggestions:[],isLoading:!1},this.debouncedLoadSuggestions=(0,c.P)(500,this.loadSuggestions)}loadSuggestions(e){const t=document.querySelector(".react-autosuggest__input").classList;t.add("user-suggestion-loading"),this.setState({isLoading:!0}),function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({q:e})};return fetch("/api/user/searchByUsername",t).then((e=>e))}(e).then((n=>{e===this.state.value?n.json().then((e=>{t.remove("user-suggestion-loading"),this.setState({isLoading:!1,suggestions:e.users.map((e=>({firstName:e.firstName,lastName:e.lastName,username:e.username,profilePicture:e.profilePicture})))})})):(t.remove("user-suggestion-loading"),this.setState({isLoading:!1}))}))}render(){const{value:e,suggestions:t}=this.state,{addTagPage:n,submitOnClick:s}=this.props,o={placeholder:"Search",value:s?"":e,onChange:this.onChange,onKeyDown:this.onKeyDown};return(0,u.jsx)(r(),{onKeyDown:this.handleOnKeyDown,suggestions:t,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:h,renderSuggestion:n?p:d,inputProps:o})}}const m=(0,l.$j)(null)(g)},14258:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Q});var s=n(72791),o=n(78417),r=n(50796),i=n(56479),a=n(62836),c=n(16303),l=n(2178),u=n(66826),h=n(74325),d=n(42363),p=n(94910),g=n(51935),m=n(67035),f=n(242),S=n.n(f);const E={connect:function(){return new Promise(((e,t)=>{const n=S()(window.location.hostname+":3000",{query:{token:JSON.parse(localStorage.getItem("user")).token}});n.on("connect",(()=>{e(n)}))}))}};var y=n(17531);const x={connect:function(){return e=>{E.connect().then((t=>{e(function(e){return{type:p.x.CONNECT,socket:e}}(t)),t.on("newNotification",(t=>{e(d.J.addNotification(t))})),t.on("newMessage",(t=>{e(y.O.newMessage(t))})),t.on("readMessages",(t=>{e({type:m.q.RECEIVE_READ_MESSAGES,data:t})})),t.on("newUser",(t=>{e({type:g.A.NEW_USER,user:t})})),t.on("imageMessageRequest",(t=>{var n;e((n={...t,sent:!1},{type:m.q.SEND_MESSAGE_REQUEST,message:n}))})),t.on("imageMessage",(t=>{var n;e({type:m.q.INC_MESSAGE_COUNT}),e((n={...t},{type:m.q.SEND_MESSAGE_SUCCESS,message:n}))})),t.on("newRoom",(t=>{e({type:m.q.INIT_MESSAGE_ARRAY,roomId:t._id}),e({type:m.q.ADD_NEW_ROOM,room:t})})),t.on("typing",(t=>{e(y.O.typing(t.roomId))})),t.on("stoppedTyping",(t=>{e(y.O.stoppedTyping(t.roomId))})),t.on("activityStatusUpdate",(t=>{e(y.O.changeActivityStatus(t))})),t.on("newCall",(t=>{e({type:m.q.OPEN_ANSWERING_MODAL,data:t})}))}))}}};var j=n(76915),_=n(87205),O=n(45463),N=n(4581),T=n(71345),A=n(62966),Z=n(14863),I=n(14541),C=n.n(I),P=n(97892),U=n.n(P),R=n(40130),w=n.n(R),v=n(72898);U().extend(w());const M=(0,u.$j)((e=>({isOpen:e.notification.isOpen,notifications:e.notification.notifications,allNotificationsCount:e.notification.allNotificationsCount})))((e=>{let{dispatch:t,isOpen:n,children:s,notifications:i,allNotificationsCount:a}=e;const c=i.map((e=>"like_post"===e.type?function(e){let{_id:t,createdAt:n,sender:s,post:i}=e;return(0,v.jsxs)(_.Z.Event,{children:[(0,v.jsx)(_.Z.Label,{image:"/images/profile-picture/100x100/".concat(s[0].profilePicture)}),(0,v.jsxs)(_.Z.Content,{children:[(0,v.jsxs)(_.Z.Summary,{children:[(0,v.jsx)(_.Z.User,{as:o.Z,to:"/"+s[0].username,children:s[0].username})," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"liked your"})," ",(0,v.jsx)(o.Z,{to:"/p/".concat(i[0]._id),children:"post"}),(0,v.jsx)(_.Z.Date,{children:U()(n).fromNow()})]}),(0,v.jsx)(_.Z.Extra,{images:!0,children:(0,v.jsx)(o.Z,{to:"/p/".concat(i[0]._id),children:(0,v.jsx)(r.Z,{rounded:!0,src:"/images/post-images/thumbnail/".concat(i[0].photo)})})})]})]},t)}(e):"follow"===e.type?function(e){let{_id:t,createdAt:n,sender:s}=e;return(0,v.jsxs)(_.Z.Event,{children:[(0,v.jsx)(_.Z.Label,{image:"/images/profile-picture/100x100/".concat(s[0].profilePicture)}),(0,v.jsx)(_.Z.Content,{children:(0,v.jsxs)(_.Z.Summary,{children:[(0,v.jsx)(_.Z.User,{as:o.Z,to:"/"+s[0].username,children:s[0].username})," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"followed you"}),(0,v.jsx)(_.Z.Date,{children:U()(n).fromNow()})]})})]},t)}(e):"post_comment"===e.type?function(e){let{_id:t,createdAt:n,sender:s,comment:i,post:a}=e;return(0,v.jsxs)(_.Z.Event,{children:[(0,v.jsx)(_.Z.Label,{image:"/images/profile-picture/100x100/".concat(s[0].profilePicture)}),(0,v.jsxs)(_.Z.Content,{children:[(0,v.jsxs)(_.Z.Summary,{children:[(0,v.jsx)(_.Z.User,{as:o.Z,to:"/"+s[0].username,children:s[0].username})," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"commented"})," ",i[0].text," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"on"})," ",(0,v.jsx)(o.Z,{to:"/p/".concat(a[0]._id),children:"post"}),(0,v.jsx)(_.Z.Date,{children:U()(n).fromNow()})]}),(0,v.jsx)(_.Z.Extra,{images:!0,children:(0,v.jsx)(o.Z,{to:"/p/".concat(a[0]._id),children:(0,v.jsx)(r.Z,{rounded:!0,src:"/images/post-images/thumbnail/".concat(a[0].photo)})})})]})]},t)}(e):"comment_reply"===e.type?function(e){let{_id:t,createdAt:n,post:s,sender:i,reply:a,comment:c}=e;return(0,v.jsxs)(_.Z.Event,{children:[(0,v.jsx)(_.Z.Label,{image:"/images/profile-picture/100x100/".concat(i[0].profilePicture)}),(0,v.jsxs)(_.Z.Content,{children:[(0,v.jsxs)(_.Z.Summary,{children:[(0,v.jsx)(_.Z.User,{as:o.Z,to:"/"+i[0].username,children:i[0].username})," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"replied"})," ",a[0].text," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"to"})," ",c[0].text,(0,v.jsx)("span",{style:{fontWeight:"normal"},children:" on "}),(0,v.jsx)(o.Z,{to:"/p/".concat(s[0]._id),children:"post"}),(0,v.jsx)(_.Z.Date,{children:U()(n).fromNow()})]}),(0,v.jsx)(_.Z.Extra,{images:!0,children:(0,v.jsx)(o.Z,{to:"/p/".concat(s[0]._id),children:(0,v.jsx)(r.Z,{rounded:!0,src:"/images/post-images/thumbnail/".concat(s[0].photo)})})})]})]},t)}(e):"comment_tagged"===e.type?function(e){let{_id:t,createdAt:n,sender:s,post:i}=e;return(0,v.jsxs)(_.Z.Event,{children:[(0,v.jsx)(_.Z.Label,{image:"/images/profile-picture/100x100/".concat(s[0].profilePicture)}),(0,v.jsxs)(_.Z.Content,{children:[(0,v.jsxs)(_.Z.Summary,{children:[(0,v.jsx)(_.Z.User,{as:o.Z,to:"/"+s[0].username,children:s[0].username})," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"mentioned you on"})," ",(0,v.jsx)(o.Z,{to:"/p/".concat(i[0]._id),children:"post"}),(0,v.jsx)(_.Z.Date,{children:U()(n).fromNow()})]}),(0,v.jsx)(_.Z.Extra,{images:!0,children:(0,v.jsx)(o.Z,{to:"/p/".concat(i[0]._id),children:(0,v.jsx)(r.Z,{rounded:!0,src:"/images/post-images/thumbnail/".concat(i[0].photo)})})})]})]},t)}(e):"post_tagged"===e.type?function(e){let{_id:t,createdAt:n,sender:s,post:i}=e;return(0,v.jsxs)(_.Z.Event,{children:[(0,v.jsx)(_.Z.Label,{image:"/images/profile-picture/100x100/".concat(s[0].profilePicture)}),(0,v.jsxs)(_.Z.Content,{children:[(0,v.jsxs)(_.Z.Summary,{children:[(0,v.jsx)(_.Z.User,{as:o.Z,to:"/"+s[0].username,children:s[0].username})," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:" tagged you on"})," ",(0,v.jsx)(o.Z,{to:"/p/".concat(i[0]._id),children:"post"}),(0,v.jsx)(_.Z.Date,{children:U()(n).fromNow()})]}),(0,v.jsx)(_.Z.Extra,{images:!0,children:(0,v.jsx)(o.Z,{to:"/p/".concat(i[0]._id),children:(0,v.jsx)(r.Z,{rounded:!0,src:"/images/post-images/thumbnail/".concat(i[0].photo)})})})]})]},t)}(e):"like_commentReply"===e.type?function(e){let{_id:t,createdAt:n,sender:s,reply:i,post:a}=e;return(0,v.jsxs)(_.Z.Event,{children:[(0,v.jsx)(_.Z.Label,{image:"/images/profile-picture/100x100/".concat(s[0].profilePicture)}),(0,v.jsxs)(_.Z.Content,{children:[(0,v.jsxs)(_.Z.Summary,{children:[(0,v.jsx)(_.Z.User,{as:o.Z,to:"/"+s[0].username,children:s[0].username})," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"liked your reply"})," ",i[0].text," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"on"})," ",(0,v.jsx)(o.Z,{to:"/p/".concat(a[0]._id),children:"post"}),(0,v.jsx)(_.Z.Date,{children:U()(n).fromNow()})]}),(0,v.jsx)(_.Z.Extra,{images:!0,children:(0,v.jsx)(o.Z,{to:"/p/".concat(a[0]._id),children:(0,v.jsx)(r.Z,{rounded:!0,src:"/images/post-images/thumbnail/".concat(a[0].photo)})})})]})]},t)}(e):function(e){let{_id:t,createdAt:n,sender:s,comment:i,post:a}=e;return(0,v.jsxs)(_.Z.Event,{children:[(0,v.jsx)(_.Z.Label,{image:"/images/profile-picture/100x100/".concat(s[0].profilePicture)}),(0,v.jsxs)(_.Z.Content,{children:[(0,v.jsxs)(_.Z.Summary,{children:[(0,v.jsx)(_.Z.User,{as:o.Z,to:"/"+s[0].username,children:s[0].username})," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"liked your comment"})," ",i[0].text," ",(0,v.jsx)("span",{style:{fontWeight:"normal"},children:"on"})," ",(0,v.jsx)(o.Z,{to:"/p/".concat(a[0]._id),children:"post"}),(0,v.jsx)(_.Z.Date,{children:U()(n).fromNow()})]}),(0,v.jsx)(_.Z.Extra,{images:!0,children:(0,v.jsx)(o.Z,{to:"/p/".concat(a[0]._id),children:(0,v.jsx)(r.Z,{rounded:!0,src:"/images/post-images/thumbnail/".concat(a[0].photo)})})})]})]},t)}(e)));return(0,v.jsx)(O.Z,{trigger:s,on:"click",position:"top center",style:{border:"none"},open:n,children:(0,v.jsx)(N.Z,{centered:!0,divided:!0,columns:"equal",children:(0,v.jsx)(T.Z,{id:"scrollableDiv",style:{overflow:"auto",maxHeight:"300px"},children:(0,v.jsxs)(T.Z.Content,{children:[" ",(0,v.jsx)(C(),{dataLength:c.length,next:()=>{const e=i[i.length-1]._id;t(d.J.fetchNotifications({initialFetch:!1,lastId:e}))},scrollableTarget:"scrollableDiv",hasMore:a!==i.length,loader:(0,v.jsx)("h4",{children:"Loading..."}),endMessage:(0,v.jsx)(A.Z,{horizontal:!0,children:(0,v.jsx)(Z.Z,{as:"h5",children:"Yay! You have seen it all"})}),children:(0,v.jsxs)(_.Z,{children:[c," "]})})]})})})})}));var b=n(68285),L=n(47823),G=n(40834),D=n(57532),k=n.n(D),q=n(84697);class J extends s.Component{constructor(){super(),this.handeAnswer=()=>{const{dispatch:e,answeringModal:t}=this.props;this.mediaHandler.getPremissions().then((n=>{this.setState({hasMedia:!0}),this.stream=n,this.peer=new(k())({stream:n}),this.peer.on("error",(e=>{console.log(e)})),this.peer.signal(t.webRtc),this.peer.on("stream",(e=>{this.userVideo.srcObject=e,this.userVideo.play()})),this.peer.on("signal",(n=>{e(y.O.answer({roomId:t.room._id,webRtc:n}))})),this.peer.on("close",(()=>{this.mediaHandler.stopRecoring(),e(y.O.endAnsweringCall()),this.setState({hasMedia:!1})})),this.myVideo.srcObject=n,this.myVideo.play()}))},this.handleClose=()=>{const{dispatch:e}=this.props;this.peer.destroy(),this.mediaHandler.stopRecoring(),this.setState({hasMedia:!1}),e(y.O.endAnsweringCall())},this.state={hasMedia:!1},this.stream=null,this.mediaHandler=new q.S}render(){const{answeringModal:e}=this.props,{hasMedia:t}=this.state;return(0,v.jsx)(s.Fragment,{children:(0,v.jsxs)(L.Z,{open:e.isOpen,children:[(0,v.jsxs)(L.Z.Content,{image:!0,children:[t?null:(0,v.jsx)(r.Z,{wrapped:!0,size:"medium",src:"http://localhost:5000/images/profile-picture/"+e.caller.profilePicture}),(0,v.jsxs)(L.Z.Description,{children:[(0,v.jsx)("video",{style:{width:300,height:"auto"},ref:e=>{this.myVideo=e}}),(0,v.jsx)("video",{style:{width:300,height:"auto"},ref:e=>{this.userVideo=e}})]})]}),(0,v.jsxs)(L.Z.Actions,{children:[(0,v.jsx)(G.Z,{negative:!0,onClick:this.handleClose,children:"Decline"}),(0,v.jsx)(G.Z,{onClick:this.handeAnswer,positive:!0,content:"Answer"})]})]})})}}const F=(0,u.$j)((e=>({user:e.user,notifications:e.notification.notifications,answeringModal:e.chat.answeringModal,currentRoom:e.chat.currentRoom,roomId:e.chat.roomId})))(J);function W(e,t){const n={profilePage:!1,userProfile:!1};t("/"===e?{...n}:"/profile"===e?{...n,profilePage:!0}:{...n,userProfile:!0})}class z extends s.Component{constructor(){super(),this.handleNotificationPopupToggle=e=>{e.stopPropagation();const{dispatch:t,notifications:n}=this.props,s=n.filter((e=>!e.read)).map((e=>e._id));if(t(d.J.toggleNotificationPopup()),n.length){const e=n[n.length-1]._id;t(d.J.fetchNotifications({initialFetch:!1,lastId:e},s))}else t(d.J.fetchNotifications({initialFetch:!0},s))},this.handleChange=(e,t)=>{let{value:n}=t;"login"===n&&(localStorage.removeItem("user"),window.location.reload(!0)),h.m.push("/"+n),this.setState({value:n})},this.state={value:"",options:[{key:"user",text:"Account",icon:"user",value:"profile",active:!1},{key:"sign-out",text:"Sign Out",icon:"sign out",value:"login",active:!1}],activePath:""},this.params={homePage:!1,profilePage:!1,userProfile:!1}}componentDidMount(){const{dispatch:e}=this.props;h.m.listen((t=>{this.setState({activePath:t.pathname}),W(t.pathname,(t=>e(j.h.getUserData(t))))})),W(h.m.location.pathname,(t=>e(j.h.getUserData(t)))),this.setState({activePath:h.m.location.pathname}),e(x.connect())}render(){const{user:e,answeringModal:t}=this.props,{value:n,options:s,activePath:u}=this.state;return e.loadingUser?null:(0,v.jsxs)("div",{className:"main-navbar",children:[(0,v.jsx)("div",{className:"nav-item logo",children:(0,v.jsx)(o.Z,{to:"/",children:"SOCIAL-NETWORK"})}),(0,v.jsx)("div",{className:"nav-item search-bar",children:(0,v.jsx)(b.L,{})}),(0,v.jsx)("div",{className:"nav-item nav-menu",children:(0,v.jsx)(i.Z,{borderless:!0,className:"top-menu",children:(0,v.jsx)(i.Z.Menu,{className:"nav-container",children:(0,v.jsxs)(i.Z.Menu,{position:"right",children:[(0,v.jsx)(i.Z.Item,{active:"/"===u,as:o.Z,to:"/",children:(0,v.jsx)(a.Z,{name:"home",size:"big"})}),(0,v.jsxs)(i.Z.Item,{active:u.includes("/messages/"),as:o.Z,to:"/messages/chat",children:[(0,v.jsx)(a.Z,{name:"facebook messenger",size:"big"}),0!==e.data.messagesCount?(0,v.jsx)(c.Z,{color:"red",style:{margin:0},children:e.data.messagesCount}):(0,v.jsx)(c.Z,{color:"grey",style:{margin:0},children:"0"})]}),(0,v.jsx)(M,{children:(0,v.jsxs)(i.Z.Item,{onClick:e=>this.handleNotificationPopupToggle(e),children:[(0,v.jsx)(a.Z,{name:"bell",size:"big"}),0!==e.data.notificationsCount?(0,v.jsx)(c.Z,{color:"red",style:{margin:0},children:e.data.notificationsCount}):(0,v.jsx)(c.Z,{color:"grey",style:{margin:0},children:"0"})]})}),(0,v.jsx)(i.Z.Item,{active:"/profile"===u,name:"avatar",id:"avatar-container",children:(0,v.jsx)(l.Z,{trigger:(h=e.data.profilePicture,(0,v.jsxs)("span",{children:[(0,v.jsx)(r.Z,{size:"mini",avatar:!0,src:"/images/profile-picture/100x100/"+h})," ",d]})),selectOnNavigation:!1,options:s,icon:null,onClose:()=>this.setState({value:""}),onChange:this.handleChange,value:n})}),(0,v.jsx)(i.Z.Item,{id:"icon-container",active:"/profile"===u,children:(0,v.jsx)(l.Z,{trigger:(0,v.jsx)(a.Z,{name:"user",size:"big"}),selectOnNavigation:!1,options:s,icon:null,onClose:()=>this.setState({value:""}),onChange:this.handleChange,value:n})})]})})})}),t.isOpen?(0,v.jsx)(F,{}):null]});var h,d}}const Q=(0,u.$j)((e=>({user:e.user,notifications:e.notification.notifications,answeringModal:e.chat.answeringModal,currentRoom:e.chat.currentRoom,roomId:e.chat.roomId})))(z)},77020:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=556.fd34385b.chunk.js.map