"use strict";(self.webpackChunksocial_network_client=self.webpackChunksocial_network_client||[]).push([[205],{69205:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var n=r(72791),o=r(78417),s=r(66826),i=r(91460),a=r(72447),l=r(40834),c=r(62836),u=r(76915),p=r(85168),h=r(72898);class d extends n.Component{constructor(e){super(e),this.componentDidMount=()=>{document.title="Login | social-network"},this.resendEmailVerification=()=>{this.props.dispatch(u.h.sendVerificationEmail(this.state.emailToVerify))},this.forgotPasswordEmail=()=>{this.props.dispatch(u.h.sendforgotPasswordEmail(this.state.forgotPasswordEmail))},this.toggleEmailVerification=()=>{this.setState({showForm:!this.state.showForm})},this.toggleForgotPasswordForm=()=>{this.setState({forgotPasswordForm:!this.state.forgotPasswordForm})},this.props.dispatch(u.h.logout()),this.state={email:"",password:"",emailToVerify:"",forgotPasswordEmail:"",submitted:!1,showForm:!1,forgotPasswordForm:!1},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleChange(e){const{name:t,value:r}=e.target;this.setState({[t]:r})}handleSubmit(e){e.preventDefault(),this.setState({submitted:!0});const{email:t,password:r}=this.state,{dispatch:n}=this.props;t&&r&&n(u.h.login(t,r))}render(){const{loggingIn:e,alert:t}=this.props,{email:r,password:n,submitted:s,showForm:u,forgotPasswordForm:d}=this.state;return(0,h.jsxs)("div",{className:"form-centered",children:[(0,h.jsx)(i.Z,{size:"large",attached:!0,header:"social-network",content:"Fill out the form below to log-in"}),(0,h.jsxs)(a.Z,{className:"attached fluid segment",size:"large",name:"form",success:"success"===t.type,error:"error"===t.type,onSubmit:this.handleSubmit,children:[(0,h.jsxs)(a.Z.Group,{widths:"equal",children:[(0,h.jsx)(a.Z.Input,{autoCapitalize:"none",label:"Email",placeholder:"Email or username",type:"text",name:"email",value:r,error:!(!s||r),onChange:this.handleChange}),(0,h.jsx)(a.Z.Input,{label:"Password",placeholder:"Password",type:"password",name:"password",value:n,error:!(!s||n),onChange:this.handleChange})]}),(0,h.jsx)(l.Z,{size:"large",fluid:!0,content:"Login",primary:!0,disabled:""===r||""===n,loading:!!e}),t.type?(0,h.jsx)(p.Z,{alert:t}):null]}),(0,h.jsxs)(i.Z,{size:"large",attached:"bottom",warning:!0,children:[(0,h.jsx)(c.Z,{name:"help"}),"Don't have an account?\xa0",(0,h.jsx)(o.Z,{to:"/register",children:"Create one now"}),(0,h.jsx)("br",{}),(0,h.jsx)(c.Z,{name:"help"}),"Forgot password?\xa0",(0,h.jsx)("span",{onClick:this.toggleForgotPasswordForm,style:{textDecoration:"underline",fontWeight:"900",cursor:"pointer"},children:"reset password"}),(0,h.jsx)("br",{}),(0,h.jsx)(c.Z,{name:"envelope"}),"Resend verification email.\xa0",(0,h.jsx)("span",{onClick:this.toggleEmailVerification,style:{textDecoration:"underline",fontWeight:"900",cursor:"pointer"},children:"resend"})]}),u?(0,h.jsxs)(a.Z,{className:"segment",size:"large",name:"form",children:[(0,h.jsxs)(a.Z.Field,{children:[(0,h.jsx)("label",{children:"Email"}),(0,h.jsx)("input",{name:"emailToVerify",placeholder:"Email",type:"email",onChange:this.handleChange})]}),(0,h.jsx)(l.Z,{fluid:!0,type:"submit",onClick:this.resendEmailVerification,children:"Resend"})]}):null,d?(0,h.jsxs)(a.Z,{className:"segment",size:"large",name:"form",children:[(0,h.jsxs)(a.Z.Field,{children:[(0,h.jsx)("label",{children:"Email"}),(0,h.jsx)("input",{name:"forgotPasswordEmail",placeholder:"Email",type:"email",onChange:this.handleChange})]}),(0,h.jsx)(l.Z,{fluid:!0,type:"submit",onClick:this.forgotPasswordEmail,children:"Send"})]}):null,(0,h.jsx)(i.Z,{children:(0,h.jsx)(i.Z.Header,{children:(0,h.jsx)("a",{href:"https://github.com/misa-j/social-network",target:"_blank",rel:"noopener noreferrer",children:"Link to a github repo"})})})]})}}const f=(0,s.$j)((e=>({loggingIn:e.authentication.loggingIn,alert:e.alert})))(d)},76915:(e,t,r)=>{r.d(t,{h:()=>p});var n=r(51935),o=r(73685);const s={login:function(e,t){const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})};return fetch("/api/user/login",r).then(a).then((e=>(localStorage.setItem("user",JSON.stringify({token:e.user.token})),e.user)))},logout:i,sendVerificationEmail:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})};return fetch("/api/user/sendVerificationEmail/",t).then(a)},sendforgotPasswordEmail:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})};return fetch("/api/user/sendforgotPasswordEmail/",t).then(a)},register:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("/api/user/signup/",t).then(a)},getUserData:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/getUserData",t).then(a).then((e=>e))},resetPassword:function(e){const t={method:"POST",headers:{Authorization:"Bearer "+e.jwt,"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/passwordreset",t).then(l).then((e=>e))},updateUser:function(e){delete e.isDisabled;const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("/api/user/updateUser",t).then(a).then((e=>(localStorage.setItem("user",JSON.stringify({token:e.token})),e)))},followUser:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({userId:e})};return fetch("/api/user/followUser",t).then(a).then((e=>e))},getUserProfileData:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({username:e.trim(),profilePage:!0})};return fetch("/api/user/getProfilePageData",t).then(a).then((e=>e))},getPosts:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/getPosts",t).then(a).then((e=>e))},getUserProfileFollowers:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({userId:e})};return fetch("/api/user/getUserProfileFollowers",t).then(a).then((e=>e))},getUserProfileFollowings:function(e){const t={method:"POST",headers:{Authorization:JSON.parse(localStorage.getItem("user")).token,"Content-Type":"application/json"},body:JSON.stringify({userId:e})};return fetch("/api/user/getUserProfileFollowings",t).then(a).then((e=>e))},getNewUsers:function(e){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e})};return fetch("/api/user/getNewUsers",t).then(a).then((e=>e))}};function i(){localStorage.removeItem("user")}function a(e){return e.text().then((t=>{const r=t&&JSON.parse(t);if(!e.ok){401===e.status&&(i(),window.location.reload(!0));const t=r&&r.message||e.statusText;return Promise.reject(t)}return r}))}function l(e){return e.text().then((t=>{const r=t&&JSON.parse(t);if(!e.ok){e.status;const t=r&&r.message||e.statusText;return Promise.reject(t)}return r}))}var c=r(44102),u=r(74325);const p={login:function(e,t){return r=>{var o;r((o={email:e},{type:n.A.LOGIN_REQUEST,user:o})),s.login(e,t).then((e=>{r(function(e){return{type:n.A.LOGIN_SUCCESS,user:e}}(e.token)),r({type:n.A.GETUSER_SUCCESS,user:e}),u.m.push("/")}),(e=>{r(function(e){return{type:n.A.LOGIN_FAILURE,error:e}}(e.toString())),r(c.I.error(e.toString()))}))}},logout:function(){return s.logout(),e=>{e({type:n.A.LOGOUT})}},register:function(e){return t=>{t(function(e){return{type:n.A.REGISTER_REQUEST,user:e}}(e)),s.register(e).then((e=>{t(function(e){return{type:n.A.REGISTER_SUCCESS,user:e}}()),u.m.push("/login"),t(c.I.success(e.message))}),(e=>{t(function(e){return{type:n.A.REGISTER_FAILURE,error:e}}(e.toString())),t(c.I.error(e.toString()))}))}},sendVerificationEmail:function(e){return t=>{s.sendVerificationEmail(e).then((e=>{t(c.I.success(e.message))}),(e=>{t(c.I.error(e))}))}},getUserData:function(e){return t=>{t({type:n.A.GETUSER_REQUEST}),s.getUserData(e).then((e=>{var r;e.user.posts&&e.user.posts.forEach((e=>t({type:o.q.INIT_COMMENT,postId:e._id}))),t((r=e.user,{type:n.A.GETUSER_SUCCESS,user:r}))}),(e=>{t(function(e){return{type:n.A.GETUSER_FAILURE,error:e}}(e.toString())),t(c.I.error(e.toString()))}))}},getUserProfileFollowers:function(e){return t=>{s.getUserProfileFollowers(e).then((e=>{var r;t((r=e.users[0].followers,{type:n.A.GET_USER_PROFILE_FOLLOWERS,users:r}))}),(e=>{console.log(e)}))}},getUserProfileFollowings:function(e){return t=>{s.getUserProfileFollowings(e).then((e=>{var r;t((r=e.users[0].following,{type:n.A.GET_USER_PROFILE_FOLLOWINGS,users:r}))}),(e=>{console.log(e)}))}},getFollowers:function(e){return t=>{s.getUserProfileFollowers(e).then((e=>{var r;t((r=e.users[0].followers,{type:n.A.GET_USER_FOLLOWERS,users:r}))}),(e=>{console.log(e)}))}},getPosts:function(e){return t=>{s.getPosts(e).then((e=>{var r;e.posts.forEach((e=>t({type:o.q.INIT_COMMENT,postId:e._id}))),t((r=e.posts,{type:n.A.GET_POSTS,posts:r}))}),(e=>{t(c.I.error(e))}))}},getUserPosts:function(e){return t=>{s.getPosts(e).then((e=>{var r;e.posts.forEach((e=>t({type:o.q.INIT_COMMENT,postId:e._id}))),t((r=e.posts,{type:n.A.GET_USER_PROFILE_POSTS,posts:r}))}),(e=>{t(c.I.error(e))}))}},getFollowings:function(e){return t=>{s.getUserProfileFollowings(e).then((e=>{var r;t((r=e.users[0].following,{type:n.A.GET_USER_FOLLOWINGS,users:r}))}),(e=>{console.log(e)}))}},updateUserData:function(e){return t=>{t({type:n.A.USER_UPDATE_REQUEST}),s.updateUser(e).then((e=>{t(function(e){return{type:n.A.USER_UPDATE_SUCCESS,user:e}}(e.user))}),(e=>{t(function(e){return{type:n.A.USER_UPDATE_FAILURE,error:e}}(e.toString()))}))}},followUser:function(e){return t=>{s.followUser(e).then((e=>{"followed"===e.action?t({type:n.A.FOLLOW_USER,user:e}):t({type:n.A.UNFOLLOW_USER,user:e})}),(e=>{console.log(e)}))}},sendforgotPasswordEmail:function(e){return t=>{s.sendforgotPasswordEmail(e).then((e=>{t(c.I.success(e.message))}),(e=>{t(c.I.error(e))}))}},getUserProfileData:function(e){return t=>{t({type:n.A.GET_USERPROFILE_DATA_REQUEST}),s.getUserProfileData(e).then((e=>{if(e.user.loggedInUser)return u.m.push("/profile");var r;document.title="@"+e.user.username+" | social-network",t((r=e,{type:n.A.GET_USERPROFILE_DATA,user:r})),e.user.posts&&e.user.posts.forEach((e=>t({type:o.q.INIT_COMMENT,postId:e._id})))}),(e=>{console.log(e),t({type:n.A.GET_USERPROFILE_DATA_FAILURE}),t(c.I.error(e.toString()))}))}},getNewUsers:function(e){return t=>{e.initialFetch||t({type:n.A.GET_NEW_USERS_REQUEST}),s.getNewUsers(e).then((r=>{var o;t((o={...r,...e},{type:n.A.GET_NEW_USERS_SUCCESS,data:o}))}),(e=>{console.log(e)}))}},resetPassword:function(e){return r=>{r({type:n.A.PASSWORD_RESET_REQUEST}),s.resetPassword(e).then((e=>{r(c.I.success(e.message)),r(t())}),(e=>{r(c.I.error(e)),r(t())}))};function t(){return{type:n.A.PASSWORD_RESET_RESPONSE}}}}},85168:(e,t,r)=>{r.d(t,{Z:()=>s});r(72791);var n=r(91460),o=r(72898);function s(e){let{alert:{type:t,message:r}}=e;return"success"===t?(0,o.jsx)(n.Z,{success:!0,header:"Success",content:r}):"error"===t?(0,o.jsx)(n.Z,{error:!0,header:"Error",content:r}):null}},78417:(e,t,r)=>{r.d(t,{Z:()=>h});var n=r(72791),o=r(52007),s=r.n(o),i=r(92176),a=r.n(i),l=r(15151),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var p=function(e){function t(){var r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,s=Array(o),i=0;i<o;i++)s[i]=arguments[i];return r=n=u(this,e.call.apply(e,[this].concat(s))),n.handleClick=function(e){if(n.props.onClick&&n.props.onClick(e),!e.defaultPrevented&&0===e.button&&!n.props.target&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)){e.preventDefault();var t=n.context.router.history,r=n.props,o=r.replace,s=r.to;o?t.replace(s):t.push(s)}},u(n,r)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.render=function(){var e=this.props,t=(e.replace,e.to),r=e.innerRef,o=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["replace","to","innerRef"]);a()(this.context.router,"You should not use <Link> outside a <Router>"),a()(void 0!==t,'You must specify the "to" property');var s=this.context.router.history,i="string"===typeof t?(0,l.ob)(t,null,null,s.location):t,u=s.createHref(i);return n.createElement("a",c({},o,{onClick:this.handleClick,href:u,ref:r}))},t}(n.Component);p.propTypes={onClick:s().func,target:s().string,replace:s().bool,to:s().oneOfType([s().string,s().object]).isRequired,innerRef:s().oneOfType([s().string,s().func])},p.defaultProps={replace:!1},p.contextTypes={router:s().shape({history:s().shape({push:s().func.isRequired,replace:s().func.isRequired,createHref:s().func.isRequired}).isRequired}).isRequired};const h=p},91460:(e,t,r)=>{r.d(t,{Z:()=>j});var n=r(87462),o=r(15671),s=r(43144),i=r(82963),a=r(61120),l=r(60136),c=r(97326),u=r(4942),p=r(42854),h=r.n(p),d=(r(41761),r(81694)),f=r.n(d),g=r(72791),m=r(47826),y=r(76755),S=r(86246),E=r(65831),w=r(42879),T=r(62836);function P(e){var t=e.children,r=e.className,o=e.content,s=f()("content",r),i=(0,y.Z)(P,e),a=(0,S.Z)(P,e);return g.createElement(a,(0,n.Z)({},i,{className:s}),E.kK(t)?o:t)}P.handledProps=["as","children","className","content"],P.propTypes={};const O=P;function U(e){var t=e.children,r=e.className,o=e.content,s=f()("header",r),i=(0,y.Z)(U,e),a=(0,S.Z)(U,e);return g.createElement(a,(0,n.Z)({},i,{className:s}),E.kK(t)?o:t)}U.handledProps=["as","children","className","content"],U.propTypes={},U.create=(0,w.u5)(U,(function(e){return{content:e}}));const _=U;var N=r(72034),I=r.n(N);function R(e){var t=e.children,r=e.className,o=e.content,s=f()("content",r),i=(0,y.Z)(R,e),a=(0,S.Z)(R,e);return g.createElement(a,(0,n.Z)({},i,{className:s}),E.kK(t)?o:t)}R.handledProps=["as","children","className","content"],R.propTypes={},R.defaultProps={as:"li"},R.create=(0,w.u5)(R,(function(e){return{content:e}}));const b=R;function v(e){var t=e.children,r=e.className,o=e.items,s=f()("list",r),i=(0,y.Z)(v,e),a=(0,S.Z)(v,e);return g.createElement(a,(0,n.Z)({},i,{className:s}),E.kK(t)?I()(o,b.create):t)}v.handledProps=["as","children","className","items"],v.propTypes={},v.defaultProps={as:"ul"},v.create=(0,w.u5)(v,(function(e){return{items:e}}));const C=v;var j=function(e){function t(){var e,r;(0,o.Z)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return r=(0,i.Z)(this,(e=(0,a.Z)(t)).call.apply(e,[this].concat(s))),(0,u.Z)((0,c.Z)((0,c.Z)(r)),"handleDismiss",(function(e){var t=r.props.onDismiss;t&&t(e,r.props)})),r}return(0,l.Z)(t,e),(0,s.Z)(t,[{key:"render",value:function(){var e=this.props,r=e.attached,o=e.children,s=e.className,i=e.color,a=e.compact,l=e.content,c=e.error,u=e.floating,p=e.header,d=e.hidden,P=e.icon,U=e.info,N=e.list,I=e.negative,R=e.onDismiss,b=e.positive,v=e.size,j=e.success,Z=e.visible,A=e.warning,x=f()("ui",i,v,(0,m.lG)(a,"compact"),(0,m.lG)(c,"error"),(0,m.lG)(u,"floating"),(0,m.lG)(d,"hidden"),(0,m.lG)(P,"icon"),(0,m.lG)(U,"info"),(0,m.lG)(I,"negative"),(0,m.lG)(b,"positive"),(0,m.lG)(j,"success"),(0,m.lG)(Z,"visible"),(0,m.lG)(A,"warning"),(0,m.sU)(r,"attached"),"message",s),F=R&&g.createElement(T.Z,{name:"close",onClick:this.handleDismiss}),k=(0,y.Z)(t,this.props),G=(0,S.Z)(t,this.props);return E.kK(o)?g.createElement(G,(0,n.Z)({},k,{className:x}),F,T.Z.create(P,{autoGenerateKey:!1}),(!h()(p)||!h()(l)||!h()(N))&&g.createElement(O,null,_.create(p,{autoGenerateKey:!1}),C.create(N,{autoGenerateKey:!1}),(0,w.BU)(l,{autoGenerateKey:!1}))):g.createElement(G,(0,n.Z)({},k,{className:x}),F,o)}}]),t}(g.Component);(0,u.Z)(j,"Content",O),(0,u.Z)(j,"Header",_),(0,u.Z)(j,"List",C),(0,u.Z)(j,"Item",b),(0,u.Z)(j,"handledProps",["as","attached","children","className","color","compact","content","error","floating","header","hidden","icon","info","list","negative","onDismiss","positive","size","success","visible","warning"]),j.propTypes={}}}]);
//# sourceMappingURL=205.a165fcf3.chunk.js.map