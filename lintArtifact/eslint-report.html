[{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\app.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\controllers\\chatController.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\controllers\\commentController.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\controllers\\notificationController.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\controllers\\postController.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\controllers\\userController.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\handlers\\emailHandler.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\handlers\\errorHandlers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\handlers\\messageHandler.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\handlers\\notificationHandler.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\changeActivityStatus.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'user' is defined but never used.","line":30,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const mongoose = require(\"mongoose\");\r\nconst User = mongoose.model(\"User\");\r\nconst Followers = mongoose.model(\"Follower\");\r\nconst messageHandler = require(\"../handlers/messageHandler\");\r\n\r\nmodule.exports = (req, res, next) => {\r\n  Followers.find({ user: mongoose.Types.ObjectId(req.body.user._id) })\r\n    .select(\"followers.user\")\r\n    .then(user => {\r\n      user[0].followers.forEach(user => {\r\n        const userId = user.user;\r\n        messageHandler.sendActivityStatus({\r\n          req,\r\n          userId,\r\n          user: req.body.user._id,\r\n          activityStatus: \"online\"\r\n        });\r\n      });\r\n    })\r\n    .catch(err => {\r\n      console.log(err.message);\r\n      return res.status(500).json({ message: err.message });\r\n    });\r\n  User.findByIdAndUpdate(\r\n    { _id: mongoose.Types.ObjectId(req.body.user._id) },\r\n    { activityStatus: \"online\" },\r\n    { new: true }\r\n  )\r\n    .select(\"activityStatus username\")\r\n    .then((user) => {\r\n      next();\r\n    })\r\n    .catch(err => {\r\n      console.log(err.message);\r\n      res.status(500).json({ message: err.message });\r\n    });\r\n};\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\chechRoom.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\checkAuth.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\checkEmailEnv.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\checkUser.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\schemaValidators\\chatValidator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\schemaValidators\\commentValidator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\schemaValidators\\notificationValidator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\schemaValidators\\postValidator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\schemaValidators\\userValidator.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\middleware\\verificationCheck.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\ChatRoom.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\Comment.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\CommentLike.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\CommentReply.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\CommentReplyLike.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\Followers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\Following.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\Message.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\Notification.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\Post.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\PostLike.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\models\\User.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\routes\\chat.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\routes\\comment.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\routes\\notification.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\routes\\post.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\routes\\user.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\test\\1_addUser.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\test\\2_loginUser.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\test\\3_getUserData.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\test\\4_getNewUsers.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\test\\5_getUserProfileData.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\test\\6_followUser.test.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /value/u.","line":113,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":113,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'user' is assigned a value but never used. Allowed unused vars must match /value/u.","line":129,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":129,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const expect = require(\"chai\").expect;\r\nconst request = require(\"supertest\");\r\nconst jwt = require(\"jsonwebtoken\");\r\nconst mongoose = require(\"mongoose\");\r\nconst app = require(\"../app\");\r\nconst { getUser } = require(\"./data/user\");\r\nconst User = require(\"../models/User\");\r\nconst ChatRoom = require(\"../models/ChatRoom\");\r\nconst Following = require(\"../models/Following\");\r\nconst Followers = require(\"../models/Followers\");\r\nconst Notification = require(\"../models/Notification\");\r\nconst fakeId = mongoose.Types.ObjectId();\r\n\r\ndescribe(\"/api/user/getUserProfileData\", () => {\r\n  let tokenJWT, userId, userId1;\r\n  it(\"getting jwt\", (done) => {\r\n    const user = {\r\n      ...getUser(0),\r\n    };\r\n    User.findOne({ username: user.username })\r\n      .select(\"_id\")\r\n      .then(({ _id }) => {\r\n        const token = jwt.sign(\r\n          {\r\n            email: user.email,\r\n            userId: _id,\r\n            username: user.username,\r\n          },\r\n          process.env.JWT_KEY,\r\n          {\r\n            expiresIn: \"30m\",\r\n          }\r\n        );\r\n        userId1 = _id;\r\n        tokenJWT = \"Bearer \" + token;\r\n        User.findOne({ username: getUser(1).username }).then(({ _id }) => {\r\n          userId = _id;\r\n          done();\r\n        });\r\n      });\r\n  });\r\n\r\n  it(\"should follow\", (done) => {\r\n    request(app)\r\n      .post(\"/api/user/followUser\")\r\n      .set(\"Authorization\", tokenJWT)\r\n      .send({ userId })\r\n      .expect(200)\r\n      .then((res) => {\r\n        expect(res.body).to.have.all.keys(\"userId\", \"action\");\r\n        expect(res.body.action).to.equal(\"followed\");\r\n        done();\r\n      })\r\n      .catch((err) => done(err));\r\n  });\r\n\r\n  it(\"should not follow itself\", (done) => {\r\n    request(app)\r\n      .post(\"/api/user/followUser\")\r\n      .set(\"Authorization\", tokenJWT)\r\n      .send({ userId: userId1 })\r\n      .expect(403)\r\n      .then((res) => {\r\n        expect(res.body).to.have.all.keys(\"message\");\r\n        expect(res.body.message).to.equal(\"Failed to follow\");\r\n        done();\r\n      })\r\n      .catch((err) => done(err));\r\n  });\r\n\r\n  it(\"should modify right documents when followed\", async () => {\r\n    const room = await ChatRoom.find();\r\n    expect(room).to.have.lengthOf(1);\r\n    expect(room[0].members).to.have.members([userId, userId1]);\r\n    expect(room[0].messages).to.equal(0);\r\n\r\n    const docF = await Following.findOne({ user: userId1 });\r\n    expect(docF.following).to.have.lengthOf(1);\r\n    expect(docF.following[0].user.toString()).to.have.equal(userId.toString());\r\n\r\n    const docN = await Notification.findOne({ receiver: userId });\r\n    expect(docN.sender.toString()).to.equal(userId1.toString());\r\n    expect(docN.receiver.toString()).to.equal(userId.toString());\r\n    expect(docN.type).to.equal(\"follow\");\r\n\r\n    const docFo = await Followers.findOne({ user: userId });\r\n    expect(docFo.followers).to.have.lengthOf(1);\r\n    expect(docFo.followers[0].user.toString()).to.have.equal(\r\n      userId1.toString()\r\n    );\r\n  });\r\n\r\n  it(\"should get followers of user 1\", (done) => {\r\n    const user = {\r\n      ...getUser(0),\r\n    };\r\n    request(app)\r\n      .post(\"/api/user/getUserProfileFollowers\")\r\n      .set(\"Authorization\", tokenJWT)\r\n      .send({ userId: userId })\r\n      .expect(200)\r\n      .then((res) => {\r\n        expect(res.body.users[0].followers).to.have.lengthOf(1);\r\n        expect(res.body.users[0].followers[0].user.username).to.equal(\r\n          user.username\r\n        );\r\n        done();\r\n      })\r\n      .catch((err) => done(err));\r\n  });\r\n\r\n  it(\"should get followings of user 1\", (done) => {\r\n    const user = {\r\n      ...getUser(0),\r\n    };\r\n    request(app)\r\n      .post(\"/api/user/getUserProfileFollowings\")\r\n      .set(\"Authorization\", tokenJWT)\r\n      .send({ userId: userId })\r\n      .expect(200)\r\n      .then((res) => {\r\n        expect(res.body.users[0].following).to.have.lengthOf(0);\r\n        done();\r\n      })\r\n      .catch((err) => done(err));\r\n  });\r\n\r\n  it(\"should get followers of user 2\", (done) => {\r\n    const user = {\r\n      ...getUser(0),\r\n    };\r\n    request(app)\r\n      .post(\"/api/user/getUserProfileFollowers\")\r\n      .set(\"Authorization\", tokenJWT)\r\n      .send({ userId: userId1 })\r\n      .expect(200)\r\n      .then((res) => {\r\n        expect(res.body.users[0].followers).to.have.lengthOf(0);\r\n        done();\r\n      })\r\n      .catch((err) => done(err));\r\n  });\r\n\r\n  it(\"should get followings of user 2\", (done) => {\r\n    const user = {\r\n      ...getUser(1),\r\n    };\r\n    request(app)\r\n      .post(\"/api/user/getUserProfileFollowings\")\r\n      .set(\"Authorization\", tokenJWT)\r\n      .send({ userId: userId1 })\r\n      .expect(200)\r\n      .then((res) => {\r\n        expect(res.body.users[0].following).to.have.lengthOf(1);\r\n        expect(res.body.users[0].following[0].user.username).to.equal(\r\n          user.username\r\n        );\r\n        done();\r\n      })\r\n      .catch((err) => done(err));\r\n  });\r\n\r\n  it(\"should unfollow\", (done) => {\r\n    request(app)\r\n      .post(\"/api/user/followUser\")\r\n      .set(\"Authorization\", tokenJWT)\r\n      .send({ userId })\r\n      .expect(200)\r\n      .then((res) => {\r\n        expect(res.body).to.have.all.keys(\"userId\", \"action\");\r\n        expect(res.body.action).to.equal(\"unfollowed\");\r\n        done();\r\n      })\r\n      .catch((err) => done(err));\r\n  });\r\n\r\n  it(\"should modify right documents when unfollowd\", async () => {\r\n    const docF = await Following.findOne({ user: userId1 });\r\n    expect(docF.following).to.have.lengthOf(0);\r\n\r\n    const docFo = await Followers.findOne({ user: userId });\r\n    expect(docFo.followers).to.have.lengthOf(0);\r\n  });\r\n\r\n  it(\"should not follow non existing user\", (done) => {\r\n    request(app)\r\n      .post(\"/api/user/followUser\")\r\n      .set(\"Authorization\", tokenJWT)\r\n      .send({ userId: fakeId })\r\n      .expect(404)\r\n      .then((res) => {\r\n        expect(res.body).to.have.all.keys(\"message\");\r\n        expect(res.body.message).to.equal(\"User not found\");\r\n        done();\r\n      })\r\n      .catch((err) => done(err));\r\n  });\r\n});\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\test\\7_updateUser.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\test\\data\\user.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\adm1\\Documents\\Semester5\\Transactional Application 2\\Final-Project\\social-network\\test\\db-handler.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]